---
title: "Habitat_Model_Multivariat"
format: html
---

# Clear R environment 
```{r}
#clear R environment -------------------------------------------
rm(list = ls())
```

# Install and load packages 
```{r}
# check for a package, install and load ---------------------------------------
pkgCheck <- function(x){ 
  if (!require(x,character.only = TRUE)){
    install.packages(x,dependencies=TRUE)
    if(!require(x,character.only = TRUE)) {
      stop()
    }
  }
}

pkgCheck("raster")
pkgCheck("spsurvey")
pkgCheck("terra")
pkgCheck("raster")
pkgCheck("ggplot2")
pkgCheck("tibble")
pkgCheck("readr")
pkgCheck("dplyr")
pkgCheck("tidyr")
```


# 1. Input-Data
## a. Water Depth
```{r}
# Read raster-files of water depths -------------------------------------------
depth_path <- "raster_files"

# read raster-files ----------------------------------------------------
depth_2 <- raster(file.path(depth_path, "Landquart_results_depth_2.tif"))
depth_3 <- raster(file.path(depth_path, "Landquart_results_depth_3.tif"))
depth_4 <- raster(file.path(depth_path, "Landquart_results_depth_4.tif"))
depth_7 <- raster(file.path(depth_path, "Landquart_results_depth_7.tif"))
depth_9 <- raster(file.path(depth_path, "Landquart_results_depth_9.tif"))
depth_11 <- raster(file.path(depth_path, "Landquart_results_depth_11.tif"))
depth_13 <- raster(file.path(depth_path, "Landquart_results_depth_13.tif"))
depth_15 <- raster(file.path(depth_path, "Landquart_results_depth_15.tif"))
depth_18 <- raster(file.path(depth_path, "Landquart_results_depth_18.tif"))
depth_22 <- raster(file.path(depth_path, "Landquart_results_depth_22.tif"))
depth_25 <- raster(file.path(depth_path, "Landquart_results_depth_25.tif"))
depth_28 <- raster(file.path(depth_path, "Landquart_results_depth_28.tif"))
depth_32 <- raster(file.path(depth_path, "Landquart_results_depth_32.tif"))

# Set all 0-cells to NA ----------------------------------------------------
depth_2[depth_2 == 0] <- NA
depth_3[depth_3 == 0] <- NA
depth_4[depth_4 == 0] <- NA
depth_7[depth_7 == 0] <- NA
depth_9[depth_9 == 0] <- NA
depth_11[depth_11 == 0] <- NA
depth_13[depth_13 == 0] <- NA
depth_15[depth_15 == 0] <- NA
depth_18[depth_18 == 0] <- NA
depth_22[depth_22 == 0] <- NA
depth_25[depth_25 == 0] <- NA
depth_28[depth_28 == 0] <- NA
depth_32[depth_32 == 0] <- NA
```

## b. Velocity 
```{r}
# Read raster-files of velocities --------------------------------------------
v_path <- "raster_files"

# read raster-files ----------------------------------------------------
velocity_2 <- raster(file.path(v_path, "Landquart_results_velocity_2.tif"))
velocity_3 <- raster(file.path(v_path, "Landquart_results_velocity_3.tif"))
velocity_4 <- raster(file.path(v_path, "Landquart_results_velocity_4.tif"))
velocity_7 <- raster(file.path(v_path, "Landquart_results_velocity_7.tif"))
velocity_9 <- raster(file.path(v_path, "Landquart_results_velocity_9.tif"))
velocity_11 <- raster(file.path(v_path, "Landquart_results_velocity_11.tif"))
velocity_13 <- raster(file.path(v_path, "Landquart_results_velocity_13.tif"))
velocity_15 <- raster(file.path(v_path, "Landquart_results_velocity_15.tif"))
velocity_18 <- raster(file.path(v_path, "Landquart_results_velocity_18.tif"))
velocity_22 <- raster(file.path(v_path, "Landquart_results_velocity_22.tif"))
velocity_25 <- raster(file.path(v_path, "Landquart_results_velocity_25.tif"))
velocity_28 <- raster(file.path(v_path, "Landquart_results_velocity_28.tif"))
velocity_32 <- raster(file.path(v_path, "Landquart_results_velocity_32.tif"))

# Set all 0-cells to NA ---------------------------------------------------
velocity_2[velocity_2 == 0] <- NA
velocity_3[velocity_3 == 0] <- NA
velocity_4[velocity_4 == 0] <- NA
velocity_7[velocity_7 == 0] <- NA
velocity_9[velocity_9 == 0] <- NA
velocity_11[velocity_11 == 0] <- NA
velocity_13[velocity_13 == 0] <- NA
velocity_15[velocity_15 == 0] <- NA
velocity_18[velocity_18 == 0] <- NA
velocity_22[velocity_22 == 0] <- NA
velocity_25[velocity_25 == 0] <- NA
velocity_28[velocity_28 == 0] <- NA
velocity_32[velocity_32 == 0] <- NA
```

## c. Substrate
```{r}
# Read raster-file of substrate --------------------------------------------
sub_path <- "raster_files"

# Read raster-file ----------------------------------------------------
sub <- raster(file.path(sub_path, "Landquart_results_substrate.tif"))

# Create a mask of non-NA values with all Q's ----------------------------------
mask_2 <- !is.na(depth_2)
mask_3 <- !is.na(depth_3)
mask_4 <- !is.na(depth_4)
mask_7 <- !is.na(depth_7)
mask_9 <- !is.na(depth_9)
mask_11 <- !is.na(depth_11)
mask_13 <- !is.na(depth_13)
mask_15 <- !is.na(depth_15)
mask_18 <- !is.na(depth_18)
mask_22 <- !is.na(depth_22)
mask_25 <- !is.na(depth_25)
mask_28 <- !is.na(depth_28)
mask_32 <- !is.na(depth_32)

# Apply the mask to the raster ------------------------------------------------
depth_masked_2 <- mask(depth_2, mask_2)
depth_masked_3 <- mask(depth_3, mask_3)
depth_masked_4 <- mask(depth_4, mask_4)
depth_masked_7 <- mask(depth_7, mask_7)
depth_masked_9 <- mask(depth_9, mask_9)
depth_masked_11 <- mask(depth_11, mask_11)
depth_masked_13 <- mask(depth_13, mask_13)
depth_masked_15 <- mask(depth_15, mask_15)
depth_masked_18 <- mask(depth_18, mask_18)
depth_masked_22 <- mask(depth_22, mask_22)
depth_masked_25 <- mask(depth_25, mask_25)
depth_masked_28 <- mask(depth_28, mask_28)
depth_masked_32 <- mask(depth_32, mask_32)

# Save the masked raster as a new file ----------------------------------------
writeRaster(depth_masked_2, "raster_files/depth_masked_2.tif", format="GTiff", overwrite = TRUE)
writeRaster(depth_masked_3, "raster_files/depth_masked_3.tif", format="GTiff", overwrite = TRUE)
writeRaster(depth_masked_4, "raster_files/depth_masked_4.tif", format="GTiff", overwrite = TRUE)
writeRaster(depth_masked_7, "raster_files/depth_masked_7.tif", format="GTiff", overwrite = TRUE)
writeRaster(depth_masked_9, "raster_files/depth_masked_9.tif", format="GTiff", overwrite = TRUE)
writeRaster(depth_masked_11, "raster_files/depth_masked_11.tif", format="GTiff", overwrite = TRUE)
writeRaster(depth_masked_13, "raster_files/depth_masked_13.tif", format="GTiff", overwrite = TRUE)
writeRaster(depth_masked_15, "raster_files/depth_masked_15.tif", format="GTiff", overwrite = TRUE)
writeRaster(depth_masked_18, "raster_files/depth_masked_18.tif", format="GTiff", overwrite = TRUE)
writeRaster(depth_masked_22, "raster_files/depth_masked_22.tif", format="GTiff", overwrite = TRUE)
writeRaster(depth_masked_25, "raster_files/depth_masked_25.tif", format="GTiff", overwrite = TRUE)
writeRaster(depth_masked_28, "raster_files/depth_masked_28.tif", format="GTiff", overwrite = TRUE)
writeRaster(depth_masked_32, "raster_files/depth_masked_32.tif", format="GTiff", overwrite = TRUE)

# Clip the raster1 with raster2 ----------------------------------------------
sub_2 <- mask(sub, depth_masked_2)
sub_3 <- mask(sub, depth_masked_3)
sub_4 <- mask(sub, depth_masked_4)
sub_7 <- mask(sub, depth_masked_7)
sub_9 <- mask(sub, depth_masked_9)
sub_11 <- mask(sub, depth_masked_11)
sub_13 <- mask(sub, depth_masked_13)
sub_15 <- mask(sub, depth_masked_15)
sub_18 <- mask(sub, depth_masked_18)
sub_22 <- mask(sub, depth_masked_22)
sub_25 <- mask(sub, depth_masked_25)
sub_28 <- mask(sub, depth_masked_28)
sub_32 <- mask(sub, depth_masked_32)

# Save the clipped raster-files as a new file --------------------------------
writeRaster(sub_2, filename="raster_files/substrate_2.tif", format="GTiff", overwrite = TRUE)
writeRaster(sub_3, filename="raster_files/substrate_3.tif", format="GTiff", overwrite = TRUE)
writeRaster(sub_4, filename="raster_files/substrate_4.tif", format="GTiff", overwrite = TRUE)
writeRaster(sub_7, filename="raster_files/substrate_7.tif", format="GTiff", overwrite = TRUE)
writeRaster(sub_9, filename="raster_files/substrate_9.tif", format="GTiff", overwrite = TRUE)
writeRaster(sub_11, filename="raster_files/substrate_11.tif", format="GTiff", overwrite = TRUE)
writeRaster(sub_13, filename="raster_files/substrate_13.tif", format="GTiff", overwrite = TRUE)
writeRaster(sub_15, filename="raster_files/substrate_15.tif", format="GTiff", overwrite = TRUE)
writeRaster(sub_18, filename="raster_files/substrate_18.tif", format="GTiff", overwrite = TRUE)
writeRaster(sub_22, filename="raster_files/substrate_22.tif", format="GTiff", overwrite = TRUE)
writeRaster(sub_25, filename="raster_files/substrate_25.tif", format="GTiff", overwrite = TRUE)
writeRaster(sub_28, filename="raster_files/substrate_28.tif", format="GTiff", overwrite = TRUE)
writeRaster(sub_32, filename="raster_files/substrate_32.tif", format="GTiff", overwrite = TRUE)
```


# 2. Habitat modelling 
## a. Suitability Curves 
```{r}
# Read suitability curves 
### WATER DEPTH ### ----------------------------------------------------
## Tanno 2012 Rhitrhogena sp. ----------------------------------------------------
sc_depth_Tanno_2012_Rhithrogena_path <- "Suitability_Curves_Data/Rhithrogena/Tanno_2012_Rhitrogena_sp_depth_winter.csv" 
sc_depth_Tanno_2012_Rhithrogena <- read.csv(sc_depth_Tanno_2012_Rhithrogena_path, sep=";", dec=".", header = TRUE)

## HABBY Rhitrhogena eaton ----------------------------------------------------
sc_depth_HABBY_Rhithrogena_path <- "Suitability_Curves_Data/Rhithrogena/HABBY_Rhitrogena_eaton_larva_depth.csv" 
sc_depth_HABBY_Rhithrogena <- read.csv(sc_depth_HABBY_Rhithrogena_path, sep=";", dec=".", header = TRUE)

## Tanno 2012 Baetis sp. ----------------------------------------------------
sc_depth_Tanno_2012_Baetis_path <- "Suitability_Curves_Data/Baetis/Tanno_2012_Baetis_sp_depth_winter.csv" 
sc_depth_Tanno_2012_Baetis <- read.csv(sc_depth_Tanno_2012_Baetis_path, sep=";", dec=".", header = TRUE)

### VELOCITY ### ----------------------------------------------------
# Tanno 2012 Rhithrogena sp. ----------------------------------------------------
sc_v_Tanno_2012_Rhithrogena_path <- "Suitability_Curves_Data/Rhithrogena/Tanno_2012_Rhithrogena_sp_velocity_winter.csv" 
sc_v_Tanno_2012_Rhithrogena <- read.csv(sc_v_Tanno_2012_Rhithrogena_path, sep=";", dec=".", header = TRUE)
# head(PK_FG)

# HABBY Rhithrogena eaton ----------------------------------------------------
sc_v_HABBY_Rhithrogena_path <- "Suitability_Curves_Data/Rhithrogena/HABBY_Rhithrogena_eaton_larva_velocity.csv" 
sc_v_HABBY_Rhithrogena <- read.csv(sc_v_HABBY_Rhithrogena_path, sep=";", dec=".", header = TRUE)

# Tanno 2012 Baetis sp. ----------------------------------------------------
sc_v_Tanno_2012_Baetis_path <- "Suitability_Curves_Data/Baetis/Tanno_2012_Baetis_sp_velocity_winter.csv" 
sc_v_Tanno_2012_Baetis <- read.csv(sc_v_Tanno_2012_Baetis_path, sep=";", dec=".", header = TRUE)

### SUBTRATE ### ----------------------------------------------------
# Tanno 2012 Baetis sp. ----------------------------------------------------
sc_sub_Baetis_path <- "Suitability_Curves_Data/Baetis/Tanno_2012_Baetis_sp_substrate_winter.csv" 
sc_sub_Baetis <- read.csv(sc_sub_Baetis_path, sep=";", dec=".", header = TRUE)

# Tanno 2012 Rhithrogena sp. ----------------------------------------------------
sc_sub_Rhithrogena_path <- "Suitability_Curves_Data/Rhithrogena/Tanno_2012_Rhithrogena_sp_substrate_winter.csv" 
sc_sub_Rhithrogena <- read.csv(sc_sub_Rhithrogena_path, sep=";", dec=".", header = TRUE)
```

```{r}
# Plot suitability curves 
### WATER DEPTH ### ----------------------------------------------------
# Tanno 2012 Rhithrogena ----------------------------------------------------
plot(approxfun(sc_depth_Tanno_2012_Rhithrogena$depth..m., sc_depth_Tanno_2012_Rhithrogena$Abundance, method = "linear", rule = 2), xlim = c(0,1.5), 
     main = "Tanno 2012: Rhithrogena sp. (winter)", col = "black",  lty = 1, lwd = 2, 
     xlab = "Depth [m]", ylab = "HS [-]")

# HABBY Rhithrogena ----------------------------------------------------
plot(approxfun(sc_depth_HABBY_Rhithrogena$depth..m., sc_depth_HABBY_Rhithrogena$Abundance, method = "linear", rule = 2), xlim = c(0,1.5), 
     main = "HABBY: Rhithrogena eaton", col = "black",  lty = 1, lwd = 2, 
     xlab = "Depth [m]", ylab = "HS [-]")

# Tanno 2012 Baetis ----------------------------------------------------
plot(approxfun(sc_depth_Tanno_2012_Baetis$depth..m., sc_depth_Tanno_2012_Baetis$Abundance, method = "linear", rule = 2), xlim = c(0,1.5), 
     main = "Tanno 2012: Baetis sp. (winter)", col = "black",  lty = 1, lwd = 2, 
     xlab = "Depth [m]", ylab = "HS [-]")

### VELOCITY ### ----------------------------------------------------
# Tanno 2012 Rhithrogena ----------------------------------------------------
plot(approxfun(sc_v_Tanno_2012_Rhithrogena$Velocity..m.s., sc_v_Tanno_2012_Rhithrogena$Abundance, method = "linear", rule = 2), xlim = c(0,1.5), 
     main = "Tanno 2012: Rhithrogena sp. (winter)", col = "black",  lty = 1, lwd = 2, 
     xlab = "Velocity [m/s]", ylab = "HS [-]")

# HABBY Rhithrogena ----------------------------------------------------
plot(approxfun(sc_v_HABBY_Rhithrogena$Velocity..m.s., sc_v_HABBY_Rhithrogena$Abundance, method = "linear", rule = 2), xlim = c(0,1.5), 
     main = "HABBY: Rhithrogena eaton", col = "black",  lty = 1, lwd = 2, 
     xlab = "Velocity [m/s]", ylab = "HS [-]")

# Tanno 2012 Baetis ----------------------------------------------------
plot(approxfun(sc_v_Tanno_2012_Baetis$Velocity..m.s., sc_v_Tanno_2012_Baetis$Abundance, method = "linear", rule = 2), xlim = c(0,1.5), 
     main = "Tanno 2012: Baetis sp. (winter)", col = "black",  lty = 1, lwd = 2, 
     xlab = "Velocity [m/s]", ylab = "HS [-]")

### SUBSTRATE ### ----------------------------------------------------
# Tanno 2012 Baetis ----------------------------------------------------
plot(approxfun(sc_sub_Baetis$Substrate.class, sc_sub_Baetis$Abundance, method = "linear", rule = 2), xlim = c(0,8.5), 
     main = "Tanno 2012: Baetis sp. (winter)", col = "black",  lty = 1, lwd = 2, 
     xlab = "Substrate class", ylab = "HS [-]")

# Tanno 2012 Rhithrogena ----------------------------------------------------
plot(approxfun(sc_sub_Rhithrogena$Substrate.class, sc_sub_Rhithrogena$Abundance, method = "linear", rule = 2), xlim = c(0,8.5), 
     main = "Tanno 2012: Rhithrogena sp. (winter)", col = "black",  lty = 1, lwd = 2, 
     xlab = "Substrate class", ylab = "HS [-]")
```


## b. Univariate HM 
### b1. water depth
```{r}
### WATER DEPTH ###
# Tanno 2012 Rhithrogena -------------------------------------------
univariat_wd_rhithrogena_tanno_2012 <- function(x, y = sc_depth_Tanno_2012_Rhithrogena$depth..m., z = sc_depth_Tanno_2012_Rhithrogena$Abundance){
  calc(x, fun = approxfun(y, z, rule = 2))
}

# ALL Q's
HS_Tanno_2012_Rhithrogena_depth_2 <- univariat_wd_rhithrogena_tanno_2012(depth_2)
HS_Tanno_2012_Rhithrogena_depth_3 <- univariat_wd_rhithrogena_tanno_2012(depth_3)
HS_Tanno_2012_Rhithrogena_depth_4 <- univariat_wd_rhithrogena_tanno_2012(depth_4)
HS_Tanno_2012_Rhithrogena_depth_7 <- univariat_wd_rhithrogena_tanno_2012(depth_7)
HS_Tanno_2012_Rhithrogena_depth_9 <- univariat_wd_rhithrogena_tanno_2012(depth_9)
HS_Tanno_2012_Rhithrogena_depth_11 <- univariat_wd_rhithrogena_tanno_2012(depth_11)
HS_Tanno_2012_Rhithrogena_depth_13 <- univariat_wd_rhithrogena_tanno_2012(depth_13)
HS_Tanno_2012_Rhithrogena_depth_15 <- univariat_wd_rhithrogena_tanno_2012(depth_15)
HS_Tanno_2012_Rhithrogena_depth_18 <- univariat_wd_rhithrogena_tanno_2012(depth_18)
HS_Tanno_2012_Rhithrogena_depth_22 <- univariat_wd_rhithrogena_tanno_2012(depth_22)
HS_Tanno_2012_Rhithrogena_depth_25 <- univariat_wd_rhithrogena_tanno_2012(depth_25)
HS_Tanno_2012_Rhithrogena_depth_28 <- univariat_wd_rhithrogena_tanno_2012(depth_28)
HS_Tanno_2012_Rhithrogena_depth_32 <- univariat_wd_rhithrogena_tanno_2012(depth_32)

# HABBY Rhithrogena -------------------------------------------
univariat_wd_rhithrogena_habby <- function(x, y = sc_depth_HABBY_Rhithrogena$depth..m., z = sc_depth_HABBY_Rhithrogena$Abundance){
  calc(x, fun = approxfun(y, z, rule = 2))
}

# All Q's 
HS_HABBY_Rhithrogena_depth_2 <- univariat_wd_rhithrogena_habby(depth_2)
HS_HABBY_Rhithrogena_depth_3 <- univariat_wd_rhithrogena_habby(depth_3)
HS_HABBY_Rhithrogena_depth_4 <- univariat_wd_rhithrogena_habby(depth_4)
HS_HABBY_Rhithrogena_depth_7 <- univariat_wd_rhithrogena_habby(depth_7)
HS_HABBY_Rhithrogena_depth_9 <- univariat_wd_rhithrogena_habby(depth_9)
HS_HABBY_Rhithrogena_depth_11 <- univariat_wd_rhithrogena_habby(depth_11)
HS_HABBY_Rhithrogena_depth_13 <- univariat_wd_rhithrogena_habby(depth_13)
HS_HABBY_Rhithrogena_depth_15 <- univariat_wd_rhithrogena_habby(depth_15)
HS_HABBY_Rhithrogena_depth_18 <- univariat_wd_rhithrogena_habby(depth_18)
HS_HABBY_Rhithrogena_depth_22 <- univariat_wd_rhithrogena_habby(depth_22)
HS_HABBY_Rhithrogena_depth_25 <- univariat_wd_rhithrogena_habby(depth_25)
HS_HABBY_Rhithrogena_depth_28 <- univariat_wd_rhithrogena_habby(depth_28)
HS_HABBY_Rhithrogena_depth_32 <- univariat_wd_rhithrogena_habby(depth_32)

# Tanno 2012 Baetis -------------------------------------------
univariat_wd_baetis_tanno_2012 <- function(x, y = sc_depth_Tanno_2012_Baetis$depth..m., z = sc_depth_Tanno_2012_Baetis$Abundance){
  calc(x, fun = approxfun(y, z, rule = 2))
}

# ALL Q's
HS_Tanno_2012_Baetis_depth_2 <- univariat_wd_baetis_tanno_2012(depth_2)
HS_Tanno_2012_Baetis_depth_3 <- univariat_wd_baetis_tanno_2012(depth_3)
HS_Tanno_2012_Baetis_depth_4 <- univariat_wd_baetis_tanno_2012(depth_4)
HS_Tanno_2012_Baetis_depth_7 <- univariat_wd_baetis_tanno_2012(depth_7)
HS_Tanno_2012_Baetis_depth_9 <- univariat_wd_baetis_tanno_2012(depth_9)
HS_Tanno_2012_Baetis_depth_11 <- univariat_wd_baetis_tanno_2012(depth_11)
HS_Tanno_2012_Baetis_depth_13 <- univariat_wd_baetis_tanno_2012(depth_13)
HS_Tanno_2012_Baetis_depth_15 <- univariat_wd_baetis_tanno_2012(depth_15)
HS_Tanno_2012_Baetis_depth_18 <- univariat_wd_baetis_tanno_2012(depth_18)
HS_Tanno_2012_Baetis_depth_22 <- univariat_wd_baetis_tanno_2012(depth_22)
HS_Tanno_2012_Baetis_depth_25 <- univariat_wd_baetis_tanno_2012(depth_25)
HS_Tanno_2012_Baetis_depth_28 <- univariat_wd_baetis_tanno_2012(depth_28)
HS_Tanno_2012_Baetis_depth_32 <- univariat_wd_baetis_tanno_2012(depth_32)

# set coordinate system (crs) -------------------------------------------
crs(HS_Tanno_2012_Rhithrogena_depth_2) <- "+proj=longlat"
crs(HS_Tanno_2012_Rhithrogena_depth_3) <- "+proj=longlat"
crs(HS_Tanno_2012_Rhithrogena_depth_4) <- "+proj=longlat"
crs(HS_Tanno_2012_Rhithrogena_depth_7) <- "+proj=longlat"
crs(HS_Tanno_2012_Rhithrogena_depth_9) <- "+proj=longlat"
crs(HS_Tanno_2012_Rhithrogena_depth_11) <- "+proj=longlat"
crs(HS_Tanno_2012_Rhithrogena_depth_13) <- "+proj=longlat"
crs(HS_Tanno_2012_Rhithrogena_depth_15) <- "+proj=longlat"
crs(HS_Tanno_2012_Rhithrogena_depth_18) <- "+proj=longlat"
crs(HS_Tanno_2012_Rhithrogena_depth_22) <- "+proj=longlat"
crs(HS_Tanno_2012_Rhithrogena_depth_25) <- "+proj=longlat"
crs(HS_Tanno_2012_Rhithrogena_depth_28) <- "+proj=longlat"
crs(HS_Tanno_2012_Rhithrogena_depth_32) <- "+proj=longlat"

crs(HS_HABBY_Rhithrogena_depth_2) <- "+proj=longlat"
crs(HS_HABBY_Rhithrogena_depth_3) <- "+proj=longlat"
crs(HS_HABBY_Rhithrogena_depth_4) <- "+proj=longlat"
crs(HS_HABBY_Rhithrogena_depth_7) <- "+proj=longlat"
crs(HS_HABBY_Rhithrogena_depth_9) <- "+proj=longlat"
crs(HS_HABBY_Rhithrogena_depth_11) <- "+proj=longlat"
crs(HS_HABBY_Rhithrogena_depth_13) <- "+proj=longlat"
crs(HS_HABBY_Rhithrogena_depth_15) <- "+proj=longlat"
crs(HS_HABBY_Rhithrogena_depth_18) <- "+proj=longlat"
crs(HS_HABBY_Rhithrogena_depth_22) <- "+proj=longlat"
crs(HS_HABBY_Rhithrogena_depth_25) <- "+proj=longlat"
crs(HS_HABBY_Rhithrogena_depth_28) <- "+proj=longlat"
crs(HS_HABBY_Rhithrogena_depth_32) <- "+proj=longlat"

crs(HS_Tanno_2012_Baetis_depth_2) <- "+proj=longlat"
crs(HS_Tanno_2012_Baetis_depth_3) <- "+proj=longlat"
crs(HS_Tanno_2012_Baetis_depth_4) <- "+proj=longlat"
crs(HS_Tanno_2012_Baetis_depth_7) <- "+proj=longlat"
crs(HS_Tanno_2012_Baetis_depth_9) <- "+proj=longlat"
crs(HS_Tanno_2012_Baetis_depth_11) <- "+proj=longlat"
crs(HS_Tanno_2012_Baetis_depth_13) <- "+proj=longlat"
crs(HS_Tanno_2012_Baetis_depth_15) <- "+proj=longlat"
crs(HS_Tanno_2012_Baetis_depth_18) <- "+proj=longlat"
crs(HS_Tanno_2012_Baetis_depth_22) <- "+proj=longlat"
crs(HS_Tanno_2012_Baetis_depth_25) <- "+proj=longlat"
crs(HS_Tanno_2012_Baetis_depth_28) <- "+proj=longlat"
crs(HS_Tanno_2012_Baetis_depth_32) <- "+proj=longlat"

# save as .tif -------------------------------------------
# Tanno 2012 Rhithrogena -------------------------------------------
writeRaster(HS_Tanno_2012_Rhithrogena_depth_2, filename="results_univariate/HS_depth_Tanno_2012_Rhithrogena_sp_winter_2.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Rhithrogena_depth_3, filename="results_univariate/HS_depth_Tanno_2012_Rhithrogena_sp_winter_3.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Rhithrogena_depth_4, filename="results_univariate/HS_depth_Tanno_2012_Rhithrogena_sp_winter_4.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Rhithrogena_depth_7, filename="results_univariate/HS_depth_Tanno_2012_Rhithrogena_sp_winter_7.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Rhithrogena_depth_9, filename="results_univariate/HS_depth_Tanno_2012_Rhithrogena_sp_winter_9.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Rhithrogena_depth_11, filename="results_univariate/HS_depth_Tanno_2012_Rhithrogena_sp_winter_11.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Rhithrogena_depth_13, filename="results_univariate/HS_depth_Tanno_2012_Rhithrogena_sp_winter_13.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Rhithrogena_depth_15, filename="results_univariate/HS_depth_Tanno_2012_Rhithrogena_sp_winter_15.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Rhithrogena_depth_18, filename="results_univariate/HS_depth_Tanno_2012_Rhithrogena_sp_winter_18.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Rhithrogena_depth_22, filename="results_univariate/HS_depth_Tanno_2012_Rhithrogena_sp_winter_22.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Rhithrogena_depth_25, filename="results_univariate/HS_depth_Tanno_2012_Rhithrogena_sp_winter_25.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Rhithrogena_depth_28, filename="results_univariate/HS_depth_Tanno_2012_Rhithrogena_sp_winter_28.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Rhithrogena_depth_32, filename="results_univariate/HS_depth_Tanno_2012_Rhithrogena_sp_winter_32.tif", format="GTiff", overwrite=TRUE)

# HABBY Rhithrogena -------------------------------------------
writeRaster(HS_HABBY_Rhithrogena_depth_2, filename="results_univariate/HS_depth_HABBY_Rhithrogena_eaton_larva_2.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_HABBY_Rhithrogena_depth_3, filename="results_univariate/HS_depth_HABBY_Rhithrogena_eaton_larva_3.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_HABBY_Rhithrogena_depth_4, filename="results_univariate/HS_depth_HABBY_Rhithrogena_eaton_larva_4.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_HABBY_Rhithrogena_depth_7, filename="results_univariate/HS_depth_HABBY_Rhithrogena_eaton_larva_7.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_HABBY_Rhithrogena_depth_9, filename="results_univariate/HS_depth_HABBY_Rhithrogena_eaton_larva_9.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_HABBY_Rhithrogena_depth_11, filename="results_univariate/HS_depth_HABBY_Rhithrogena_eaton_larva_11.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_HABBY_Rhithrogena_depth_13, filename="results_univariate/HS_depth_HABBY_Rhithrogena_eaton_larva_13.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_HABBY_Rhithrogena_depth_15, filename="results_univariate/HS_depth_HABBY_Rhithrogena_eaton_larva_15.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_HABBY_Rhithrogena_depth_18, filename="results_univariate/HS_depth_HABBY_Rhithrogena_eaton_larva_18.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_HABBY_Rhithrogena_depth_22, filename="results_univariate/HS_depth_HABBY_Rhithrogena_eaton_larva_22.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_HABBY_Rhithrogena_depth_25, filename="results_univariate/HS_depth_HABBY_Rhithrogena_eaton_larva_25.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_HABBY_Rhithrogena_depth_28, filename="results_univariate/HS_depth_HABBY_Rhithrogena_eaton_larva_28.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_HABBY_Rhithrogena_depth_32, filename="results_univariate/HS_depth_HABBY_Rhithrogena_eaton_larva_32.tif", format="GTiff", overwrite=TRUE)

# Tanno 2012 Baetis -------------------------------------------
writeRaster(HS_Tanno_2012_Baetis_depth_2, filename="results_univariate/HS_depth_Tanno_2012_Baetis_sp_winter_2.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Baetis_depth_3, filename="results_univariate/HS_depth_Tanno_2012_Baetis_sp_winter_3.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Baetis_depth_4, filename="results_univariate/HS_depth_Tanno_2012_Baetis_sp_winter_4.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Baetis_depth_7, filename="results_univariate/HS_depth_Tanno_2012_Baetis_sp_winter_7.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Baetis_depth_9, filename="results_univariate/HS_depth_Tanno_2012_Baetis_sp_winter_9.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Baetis_depth_11, filename="results_univariate/HS_depth_Tanno_2012_Baetis_sp_winter_11.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Baetis_depth_13, filename="results_univariate/HS_depth_Tanno_2012_Baetis_sp_winter_13.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Baetis_depth_15, filename="results_univariate/HS_depth_Tanno_2012_Baetis_sp_winter_15.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Baetis_depth_18, filename="results_univariate/HS_depth_Tanno_2012_Baetis_sp_winter_18.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Baetis_depth_22, filename="results_univariate/HS_depth_Tanno_2012_Baetis_sp_winter_22.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Baetis_depth_25, filename="results_univariate/HS_depth_Tanno_2012_Baetis_sp_winter_25.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Baetis_depth_28, filename="results_univariate/HS_depth_Tanno_2012_Baetis_sp_winter_28.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Baetis_depth_32, filename="results_univariate/HS_depth_Tanno_2012_Baetis_sp_winter_32.tif", format="GTiff", overwrite=TRUE)
```

### b2. velocity
```{r}
### VELOCITY ###
# Tanno 2012 Rhithrogena -------------------------------------------
univariat_v_rhithrogena_tanno_2012 <- function(x, y = sc_v_Tanno_2012_Rhithrogena$Velocity..m.s., z = sc_v_Tanno_2012_Rhithrogena$Abundance){
  calc(x, fun = approxfun(y, z, rule = 2))
}

# ALL Q's
HS_Tanno_2012_Rhithrogena_velocity_2 <- univariat_v_rhithrogena_tanno_2012(velocity_2)
HS_Tanno_2012_Rhithrogena_velocity_3 <- univariat_v_rhithrogena_tanno_2012(velocity_3)
HS_Tanno_2012_Rhithrogena_velocity_4 <- univariat_v_rhithrogena_tanno_2012(velocity_4)
HS_Tanno_2012_Rhithrogena_velocity_7 <- univariat_v_rhithrogena_tanno_2012(velocity_7)
HS_Tanno_2012_Rhithrogena_velocity_9 <- univariat_v_rhithrogena_tanno_2012(velocity_9)
HS_Tanno_2012_Rhithrogena_velocity_11 <- univariat_v_rhithrogena_tanno_2012(velocity_11)
HS_Tanno_2012_Rhithrogena_velocity_13 <- univariat_v_rhithrogena_tanno_2012(velocity_13)
HS_Tanno_2012_Rhithrogena_velocity_15 <- univariat_v_rhithrogena_tanno_2012(velocity_15)
HS_Tanno_2012_Rhithrogena_velocity_18 <- univariat_v_rhithrogena_tanno_2012(velocity_18)
HS_Tanno_2012_Rhithrogena_velocity_22 <- univariat_v_rhithrogena_tanno_2012(velocity_22)
HS_Tanno_2012_Rhithrogena_velocity_25 <- univariat_v_rhithrogena_tanno_2012(velocity_25)
HS_Tanno_2012_Rhithrogena_velocity_28 <- univariat_v_rhithrogena_tanno_2012(velocity_28)
HS_Tanno_2012_Rhithrogena_velocity_32 <- univariat_v_rhithrogena_tanno_2012(velocity_32)


# HABBY Rhithrogena -------------------------------------------
univariat_v_rhithrogena_habby <- function(x, y = sc_v_HABBY_Rhithrogena$Velocity..m.s., z = sc_v_HABBY_Rhithrogena$Abundance){
  calc(x, fun = approxfun(y, z, rule = 2))
}

# ALL Q's
HS_HABBY_Rhithrogena_velocity_2 <- univariat_v_rhithrogena_habby(velocity_2)
HS_HABBY_Rhithrogena_velocity_3 <- univariat_v_rhithrogena_habby(velocity_3)
HS_HABBY_Rhithrogena_velocity_4 <- univariat_v_rhithrogena_habby(velocity_4)
HS_HABBY_Rhithrogena_velocity_7 <- univariat_v_rhithrogena_habby(velocity_7)
HS_HABBY_Rhithrogena_velocity_9 <- univariat_v_rhithrogena_habby(velocity_9)
HS_HABBY_Rhithrogena_velocity_11 <- univariat_v_rhithrogena_habby(velocity_11)
HS_HABBY_Rhithrogena_velocity_13 <- univariat_v_rhithrogena_habby(velocity_13)
HS_HABBY_Rhithrogena_velocity_15 <- univariat_v_rhithrogena_habby(velocity_15)
HS_HABBY_Rhithrogena_velocity_18 <- univariat_v_rhithrogena_habby(velocity_18)
HS_HABBY_Rhithrogena_velocity_22 <- univariat_v_rhithrogena_habby(velocity_22)
HS_HABBY_Rhithrogena_velocity_25 <- univariat_v_rhithrogena_habby(velocity_25)
HS_HABBY_Rhithrogena_velocity_28 <- univariat_v_rhithrogena_habby(velocity_28)
HS_HABBY_Rhithrogena_velocity_32 <- univariat_v_rhithrogena_habby(velocity_32)


# Tanno 2012 Baetis -------------------------------------------
univariat_v_baetis_tanno_2012 <- function(x, y = sc_v_Tanno_2012_Baetis$Velocity..m.s., z = sc_v_Tanno_2012_Baetis$Abundance){
  calc(x, fun = approxfun(y, z, rule = 2))
}

# ALL Q's
HS_Tanno_2012_Baetis_velocity_2 <- univariat_v_baetis_tanno_2012(velocity_2)
HS_Tanno_2012_Baetis_velocity_3 <- univariat_v_baetis_tanno_2012(velocity_3)
HS_Tanno_2012_Baetis_velocity_4 <- univariat_v_baetis_tanno_2012(velocity_4)
HS_Tanno_2012_Baetis_velocity_7 <- univariat_v_baetis_tanno_2012(velocity_7)
HS_Tanno_2012_Baetis_velocity_9 <- univariat_v_baetis_tanno_2012(velocity_9)
HS_Tanno_2012_Baetis_velocity_11 <- univariat_v_baetis_tanno_2012(velocity_11)
HS_Tanno_2012_Baetis_velocity_13 <- univariat_v_baetis_tanno_2012(velocity_13)
HS_Tanno_2012_Baetis_velocity_15 <- univariat_v_baetis_tanno_2012(velocity_15)
HS_Tanno_2012_Baetis_velocity_18 <- univariat_v_baetis_tanno_2012(velocity_18)
HS_Tanno_2012_Baetis_velocity_22 <- univariat_v_baetis_tanno_2012(velocity_22)
HS_Tanno_2012_Baetis_velocity_25 <- univariat_v_baetis_tanno_2012(velocity_25)
HS_Tanno_2012_Baetis_velocity_28 <- univariat_v_baetis_tanno_2012(velocity_28)
HS_Tanno_2012_Baetis_velocity_32 <- univariat_v_baetis_tanno_2012(velocity_32)

# Koordinatensystem (crs) -------------------------------------------
crs(HS_Tanno_2012_Rhithrogena_velocity_2) <- "+proj=longlat"
crs(HS_Tanno_2012_Rhithrogena_velocity_3) <- "+proj=longlat"
crs(HS_Tanno_2012_Rhithrogena_velocity_4) <- "+proj=longlat"
crs(HS_Tanno_2012_Rhithrogena_velocity_7) <- "+proj=longlat"
crs(HS_Tanno_2012_Rhithrogena_velocity_9) <- "+proj=longlat"
crs(HS_Tanno_2012_Rhithrogena_velocity_11) <- "+proj=longlat"
crs(HS_Tanno_2012_Rhithrogena_velocity_13) <- "+proj=longlat"
crs(HS_Tanno_2012_Rhithrogena_velocity_15) <- "+proj=longlat"
crs(HS_Tanno_2012_Rhithrogena_velocity_18) <- "+proj=longlat"
crs(HS_Tanno_2012_Rhithrogena_velocity_22) <- "+proj=longlat"
crs(HS_Tanno_2012_Rhithrogena_velocity_25) <- "+proj=longlat"
crs(HS_Tanno_2012_Rhithrogena_velocity_28) <- "+proj=longlat"
crs(HS_Tanno_2012_Rhithrogena_velocity_32) <- "+proj=longlat"

crs(HS_HABBY_Rhithrogena_velocity_2) <- "+proj=longlat"
crs(HS_HABBY_Rhithrogena_velocity_3) <- "+proj=longlat"
crs(HS_HABBY_Rhithrogena_velocity_4) <- "+proj=longlat"
crs(HS_HABBY_Rhithrogena_velocity_7) <- "+proj=longlat"
crs(HS_HABBY_Rhithrogena_velocity_9) <- "+proj=longlat"
crs(HS_HABBY_Rhithrogena_velocity_11) <- "+proj=longlat"
crs(HS_HABBY_Rhithrogena_velocity_13) <- "+proj=longlat"
crs(HS_HABBY_Rhithrogena_velocity_15) <- "+proj=longlat"
crs(HS_HABBY_Rhithrogena_velocity_18) <- "+proj=longlat"
crs(HS_HABBY_Rhithrogena_velocity_22) <- "+proj=longlat"
crs(HS_HABBY_Rhithrogena_velocity_25) <- "+proj=longlat"
crs(HS_HABBY_Rhithrogena_velocity_28) <- "+proj=longlat"
crs(HS_HABBY_Rhithrogena_velocity_32) <- "+proj=longlat"

crs(HS_Tanno_2012_Baetis_velocity_2) <- "+proj=longlat"
crs(HS_Tanno_2012_Baetis_velocity_3) <- "+proj=longlat"
crs(HS_Tanno_2012_Baetis_velocity_4) <- "+proj=longlat"
crs(HS_Tanno_2012_Baetis_velocity_7) <- "+proj=longlat"
crs(HS_Tanno_2012_Baetis_velocity_9) <- "+proj=longlat"
crs(HS_Tanno_2012_Baetis_velocity_11) <- "+proj=longlat"
crs(HS_Tanno_2012_Baetis_velocity_13) <- "+proj=longlat"
crs(HS_Tanno_2012_Baetis_velocity_15) <- "+proj=longlat"
crs(HS_Tanno_2012_Baetis_velocity_18) <- "+proj=longlat"
crs(HS_Tanno_2012_Baetis_velocity_22) <- "+proj=longlat"
crs(HS_Tanno_2012_Baetis_velocity_25) <- "+proj=longlat"
crs(HS_Tanno_2012_Baetis_velocity_28) <- "+proj=longlat"
crs(HS_Tanno_2012_Baetis_velocity_32) <- "+proj=longlat"

# save as .tif -------------------------------------------
# Tanno 2012: Rhithrogena -------------------------------------------
writeRaster(HS_Tanno_2012_Rhithrogena_velocity_2, filename="results_univariate/HS_velocity_Tanno_2012_Rhithrogena_sp_winter_2.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Rhithrogena_velocity_3, filename="results_univariate/HS_velocity_Tanno_2012_Rhithrogena_sp_winter_3.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Rhithrogena_velocity_4, filename="results_univariate/HS_velocity_Tanno_2012_Rhithrogena_sp_winter_4.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Rhithrogena_velocity_7, filename="results_univariate/HS_velocity_Tanno_2012_Rhithrogena_sp_winter_7.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Rhithrogena_velocity_9, filename="results_univariate/HS_velocity_Tanno_2012_Rhithrogena_sp_winter_9.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Rhithrogena_velocity_11, filename="results_univariate/HS_velocity_Tanno_2012_Rhithrogena_sp_winter_11.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Rhithrogena_velocity_13, filename="results_univariate/HS_velocity_Tanno_2012_Rhithrogena_sp_winter_13.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Rhithrogena_velocity_15, filename="results_univariate/HS_velocity_Tanno_2012_Rhithrogena_sp_winter_15.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Rhithrogena_velocity_18, filename="results_univariate/HS_velocity_Tanno_2012_Rhithrogena_sp_winter_18.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Rhithrogena_velocity_22, filename="results_univariate/HS_velocity_Tanno_2012_Rhithrogena_sp_winter_22.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Rhithrogena_velocity_25, filename="results_univariate/HS_velocity_Tanno_2012_Rhithrogena_sp_winter_25.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Rhithrogena_velocity_28, filename="results_univariate/HS_velocity_Tanno_2012_Rhithrogena_sp_winter_28.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Rhithrogena_velocity_32, filename="results_univariate/HS_velocity_Tanno_2012_Rhithrogena_sp_winter_32.tif", format="GTiff", overwrite=TRUE)

# HABBY Rhithrogena -------------------------------------------
writeRaster(HS_HABBY_Rhithrogena_velocity_2, filename="results_univariate/HS_velocity_HABBY_Rhithrogena_eaton_larva_2.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_HABBY_Rhithrogena_velocity_3, filename="results_univariate/HS_velocity_HABBY_Rhithrogena_eaton_larva_3.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_HABBY_Rhithrogena_velocity_4, filename="results_univariate/HS_velocity_HABBY_Rhithrogena_eaton_larva_4.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_HABBY_Rhithrogena_velocity_7, filename="results_univariate/HS_velocity_HABBY_Rhithrogena_eaton_larva_7.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_HABBY_Rhithrogena_velocity_9, filename="results_univariate/HS_velocity_HABBY_Rhithrogena_eaton_larva_9.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_HABBY_Rhithrogena_velocity_11, filename="results_univariate/HS_velocity_HABBY_Rhithrogena_eaton_larva_11.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_HABBY_Rhithrogena_velocity_13, filename="results_univariate/HS_velocity_HABBY_Rhithrogena_eaton_larva_13.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_HABBY_Rhithrogena_velocity_15, filename="results_univariate/HS_velocity_HABBY_Rhithrogena_eaton_larva_15.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_HABBY_Rhithrogena_velocity_18, filename="results_univariate/HS_velocity_HABBY_Rhithrogena_eaton_larva_18.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_HABBY_Rhithrogena_velocity_22, filename="results_univariate/HS_velocity_HABBY_Rhithrogena_eaton_larva_22.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_HABBY_Rhithrogena_velocity_25, filename="results_univariate/HS_velocity_HABBY_Rhithrogena_eaton_larva_25.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_HABBY_Rhithrogena_velocity_28, filename="results_univariate/HS_velocity_HABBY_Rhithrogena_eaton_larva_28.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_HABBY_Rhithrogena_velocity_32, filename="results_univariate/HS_velocity_HABBY_Rhithrogena_eaton_larva_32.tif", format="GTiff", overwrite=TRUE)

# Tanno 2012 Baetis -------------------------------------------
writeRaster(HS_Tanno_2012_Baetis_velocity_2, filename="results_univariate/HS_velocity_Tanno_2012_Baetis_sp_winter_2.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Baetis_velocity_3, filename="results_univariate/HS_velocity_Tanno_2012_Baetis_sp_winter_3.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Baetis_velocity_4, filename="results_univariate/HS_velocity_Tanno_2012_Baetis_sp_winter_4.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Baetis_velocity_7, filename="results_univariate/HS_velocity_Tanno_2012_Baetis_sp_winter_7.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Baetis_velocity_9, filename="results_univariate/HS_velocity_Tanno_2012_Baetis_sp_winter_9.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Baetis_velocity_11, filename="results_univariate/HS_velocity_Tanno_2012_Baetis_sp_winter_11.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Baetis_velocity_13, filename="results_univariate/HS_velocity_Tanno_2012_Baetis_sp_winter_13.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Baetis_velocity_15, filename="results_univariate/HS_velocity_Tanno_2012_Baetis_sp_winter_15.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Baetis_velocity_18, filename="results_univariate/HS_velocity_Tanno_2012_Baetis_sp_winter_18.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Baetis_velocity_22, filename="results_univariate/HS_velocity_Tanno_2012_Baetis_sp_winter_22.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Baetis_velocity_25, filename="results_univariate/HS_velocity_Tanno_2012_Baetis_sp_winter_25.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Baetis_velocity_28, filename="results_univariate/HS_velocity_Tanno_2012_Baetis_sp_winter_28.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_Tanno_2012_Baetis_velocity_32, filename="results_univariate/HS_velocity_Tanno_2012_Baetis_sp_winter_32.tif", format="GTiff", overwrite=TRUE)
```

### * b3. persistent habitat velocity
```{r}
# Clip the raster1 with raster2
# Tanno 2012 Rhithrogena -------------------------------------------
v_tanno_2012_rhith_pers_2 <- mask(HS_Tanno_2012_Rhithrogena_velocity_2, HS_Tanno_2012_Rhithrogena_velocity_2)

v_tanno_2012_rhith_pers_3 <- mask(HS_Tanno_2012_Rhithrogena_velocity_3, HS_Tanno_2012_Rhithrogena_velocity_2)

v_tanno_2012_rhith_pers_4 <- mask(HS_Tanno_2012_Rhithrogena_velocity_4, HS_Tanno_2012_Rhithrogena_velocity_2)

v_tanno_2012_rhith_pers_7 <- mask(HS_Tanno_2012_Rhithrogena_velocity_7, HS_Tanno_2012_Rhithrogena_velocity_2)

v_tanno_2012_rhith_pers_9 <- mask(HS_Tanno_2012_Rhithrogena_velocity_9, HS_Tanno_2012_Rhithrogena_velocity_2)

v_tanno_2012_rhith_pers_11 <- mask(HS_Tanno_2012_Rhithrogena_velocity_11, HS_Tanno_2012_Rhithrogena_velocity_2)

v_tanno_2012_rhith_pers_13 <- mask(HS_Tanno_2012_Rhithrogena_velocity_13, HS_Tanno_2012_Rhithrogena_velocity_2)

v_tanno_2012_rhith_pers_15 <- mask(HS_Tanno_2012_Rhithrogena_velocity_15, HS_Tanno_2012_Rhithrogena_velocity_2)

v_tanno_2012_rhith_pers_18 <- mask(HS_Tanno_2012_Rhithrogena_velocity_18, HS_Tanno_2012_Rhithrogena_velocity_2)

v_tanno_2012_rhith_pers_22 <- mask(HS_Tanno_2012_Rhithrogena_velocity_22, HS_Tanno_2012_Rhithrogena_velocity_2)

v_tanno_2012_rhith_pers_25 <- mask(HS_Tanno_2012_Rhithrogena_velocity_25, HS_Tanno_2012_Rhithrogena_velocity_2)

v_tanno_2012_rhith_pers_28 <- mask(HS_Tanno_2012_Rhithrogena_velocity_28, HS_Tanno_2012_Rhithrogena_velocity_2)

v_tanno_2012_rhith_pers_32 <- mask(HS_Tanno_2012_Rhithrogena_velocity_32, HS_Tanno_2012_Rhithrogena_velocity_2)

# HABBY Rhithrogena -------------------------------------------
v_habby_rhith_pers_2 <- mask(HS_HABBY_Rhithrogena_velocity_2, HS_HABBY_Rhithrogena_velocity_2)

v_habby_rhith_pers_3 <- mask(HS_HABBY_Rhithrogena_velocity_3, HS_HABBY_Rhithrogena_velocity_2)

v_habby_rhith_pers_4 <- mask(HS_HABBY_Rhithrogena_velocity_4, HS_HABBY_Rhithrogena_velocity_2)

v_habby_rhith_pers_7 <- mask(HS_HABBY_Rhithrogena_velocity_7, HS_HABBY_Rhithrogena_velocity_2)

v_habby_rhith_pers_9 <- mask(HS_HABBY_Rhithrogena_velocity_9, HS_HABBY_Rhithrogena_velocity_2)

v_habby_rhith_pers_11 <- mask(HS_HABBY_Rhithrogena_velocity_11, HS_HABBY_Rhithrogena_velocity_2)

v_habby_rhith_pers_13 <- mask(HS_HABBY_Rhithrogena_velocity_13, HS_HABBY_Rhithrogena_velocity_2)

v_habby_rhith_pers_15 <- mask(HS_HABBY_Rhithrogena_velocity_15, HS_HABBY_Rhithrogena_velocity_2)

v_habby_rhith_pers_18 <- mask(HS_HABBY_Rhithrogena_velocity_18, HS_HABBY_Rhithrogena_velocity_2)

v_habby_rhith_pers_22 <- mask(HS_HABBY_Rhithrogena_velocity_22, HS_HABBY_Rhithrogena_velocity_2)

v_habby_rhith_pers_25 <- mask(HS_HABBY_Rhithrogena_velocity_25, HS_HABBY_Rhithrogena_velocity_2)

v_habby_rhith_pers_28 <- mask(HS_HABBY_Rhithrogena_velocity_28, HS_HABBY_Rhithrogena_velocity_2)

v_habby_rhith_pers_32 <- mask(HS_HABBY_Rhithrogena_velocity_32, HS_HABBY_Rhithrogena_velocity_2)

# Tanno 2012 Baetis sp. -------------------------------------------
v_tanno_2012_baetis_pers_2 <- mask(HS_Tanno_2012_Baetis_velocity_2, HS_Tanno_2012_Baetis_velocity_2)

v_tanno_2012_baetis_pers_3 <- mask(HS_Tanno_2012_Baetis_velocity_3, HS_Tanno_2012_Baetis_velocity_2)

v_tanno_2012_baetis_pers_4 <- mask(HS_Tanno_2012_Baetis_velocity_4, HS_Tanno_2012_Baetis_velocity_2)

v_tanno_2012_baetis_pers_7 <- mask(HS_Tanno_2012_Baetis_velocity_7, HS_Tanno_2012_Baetis_velocity_2)

v_tanno_2012_baetis_pers_9 <- mask(HS_Tanno_2012_Baetis_velocity_9, HS_Tanno_2012_Baetis_velocity_2)

v_tanno_2012_baetis_pers_11 <- mask(HS_Tanno_2012_Baetis_velocity_11, HS_Tanno_2012_Baetis_velocity_2)

v_tanno_2012_baetis_pers_13 <- mask(HS_Tanno_2012_Baetis_velocity_13, HS_Tanno_2012_Baetis_velocity_2)

v_tanno_2012_baetis_pers_15 <- mask(HS_Tanno_2012_Baetis_velocity_15, HS_Tanno_2012_Baetis_velocity_2)

v_tanno_2012_baetis_pers_18 <- mask(HS_Tanno_2012_Baetis_velocity_18, HS_Tanno_2012_Baetis_velocity_2)

v_tanno_2012_baetis_pers_22 <- mask(HS_Tanno_2012_Baetis_velocity_22, HS_Tanno_2012_Baetis_velocity_2)

v_tanno_2012_baetis_pers_25 <- mask(HS_Tanno_2012_Baetis_velocity_25, HS_Tanno_2012_Baetis_velocity_2)

v_tanno_2012_baetis_pers_28 <- mask(HS_Tanno_2012_Baetis_velocity_28, HS_Tanno_2012_Baetis_velocity_2)

v_tanno_2012_baetis_pers_32 <- mask(HS_Tanno_2012_Baetis_velocity_32, HS_Tanno_2012_Baetis_velocity_2)

# Save the clipped raster-files as a new file -------------------------
# Tanno 2012 Rhithrogena -------------------------------------------
writeRaster(v_tanno_2012_rhith_pers_2, filename="results_univariate/v_tanno_2012_rhith_pers_2.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_tanno_2012_rhith_pers_3, filename="results_univariate/v_tanno_2012_rhith_pers_3.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_tanno_2012_rhith_pers_4, filename="results_univariate/v_tanno_2012_rhith_pers_4.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_tanno_2012_rhith_pers_7, filename="results_univariate/v_tanno_2012_rhith_pers_7.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_tanno_2012_rhith_pers_9, filename="results_univariate/v_tanno_2012_rhith_pers_9.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_tanno_2012_rhith_pers_11, filename="results_univariate/v_tanno_2012_rhith_pers_11.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_tanno_2012_rhith_pers_13, filename="results_univariate/v_tanno_2012_rhith_pers_13.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_tanno_2012_rhith_pers_15, filename="results_univariate/v_tanno_2012_rhith_pers_15.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_tanno_2012_rhith_pers_18, filename="results_univariate/v_tanno_2012_rhith_pers_18.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_tanno_2012_rhith_pers_22, filename="results_univariate/v_tanno_2012_rhith_pers_22.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_tanno_2012_rhith_pers_25, filename="results_univariate/v_tanno_2012_rhith_pers_25.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_tanno_2012_rhith_pers_28, filename="results_univariate/v_tanno_2012_rhith_pers_28.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_tanno_2012_rhith_pers_32, filename="results_univariate/v_tanno_2012_rhith_pers_32.tif", format="GTiff", overwrite = TRUE)

# HABBY Rhithrogena -------------------------------------------
writeRaster(v_habby_rhith_pers_2, filename="results_univariate/v_habby_rhith_pers_2.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_habby_rhith_pers_3, filename="results_univariate/v_habby_rhith_pers_3.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_habby_rhith_pers_4, filename="results_univariate/v_habby_rhith_pers_4.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_habby_rhith_pers_7, filename="results_univariate/v_habby_rhith_pers_7.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_habby_rhith_pers_9, filename="results_univariate/v_habby_rhith_pers_9.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_habby_rhith_pers_11, filename="results_univariate/v_habby_rhith_pers_11.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_habby_rhith_pers_13, filename="results_univariate/v_habby_rhith_pers_13.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_habby_rhith_pers_15, filename="results_univariate/v_habby_rhith_pers_15.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_habby_rhith_pers_18, filename="results_univariate/v_habby_rhith_pers_18.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_habby_rhith_pers_22, filename="results_univariate/v_habby_rhith_pers_22.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_habby_rhith_pers_25, filename="results_univariate/v_habby_rhith_pers_25.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_habby_rhith_pers_28, filename="results_univariate/v_habby_rhith_pers_28.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_habby_rhith_pers_32, filename="results_univariate/v_habby_rhith_pers_32.tif", format="GTiff", overwrite = TRUE)

# Tanno 2012 Baetis sp. -------------------------------------------
writeRaster(v_tanno_2012_baetis_pers_2, filename="results_univariate/v_tanno_2012_baetis_pers_2.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_tanno_2012_baetis_pers_3, filename="results_univariate/v_tanno_2012_baetis_pers_3.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_tanno_2012_baetis_pers_4, filename="results_univariate/v_tanno_2012_baetis_pers_4.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_tanno_2012_baetis_pers_7, filename="results_univariate/v_tanno_2012_baetis_pers_7.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_tanno_2012_baetis_pers_9, filename="results_univariate/v_tanno_2012_baetis_pers_9.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_tanno_2012_baetis_pers_11, filename="results_univariate/v_tanno_2012_baetis_pers_11.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_tanno_2012_baetis_pers_13, filename="results_univariate/v_tanno_2012_baetis_pers_13.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_tanno_2012_baetis_pers_15, filename="results_univariate/v_tanno_2012_baetis_pers_15.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_tanno_2012_baetis_pers_18, filename="results_univariate/v_tanno_2012_baetis_pers_18.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_tanno_2012_baetis_pers_22, filename="results_univariate/v_tanno_2012_baetis_pers_22.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_tanno_2012_baetis_pers_25, filename="results_univariate/v_tanno_2012_baetis_pers_25.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_tanno_2012_baetis_pers_28, filename="results_univariate/v_tanno_2012_baetis_pers_28.tif", format="GTiff", overwrite = TRUE)

writeRaster(v_tanno_2012_baetis_pers_32, filename="results_univariate/v_tanno_2012_baetis_pers_32.tif", format="GTiff", overwrite = TRUE)
```

### b3. substrate
```{r}
# Substrate (Sub)
# Tanno 2012: Baetis sp. -------------------------------------------
univariat_sub_baetis <- function(x, y = sc_sub_Baetis$Substrate.class, z = sc_sub_Baetis$Abundance){
  calc(x, fun = approxfun(y, z, rule = 2))
}

# All Q's 
HS_sub_Baetis_2 <- univariat_sub_baetis(sub_2)
HS_sub_Baetis_3 <- univariat_sub_baetis(sub_3)
HS_sub_Baetis_4 <- univariat_sub_baetis(sub_4)
HS_sub_Baetis_7 <- univariat_sub_baetis(sub_7)
HS_sub_Baetis_9 <- univariat_sub_baetis(sub_9)
HS_sub_Baetis_11 <- univariat_sub_baetis(sub_11)
HS_sub_Baetis_13 <- univariat_sub_baetis(sub_13)
HS_sub_Baetis_15 <- univariat_sub_baetis(sub_15)
HS_sub_Baetis_18 <- univariat_sub_baetis(sub_18)
HS_sub_Baetis_22 <- univariat_sub_baetis(sub_22)
HS_sub_Baetis_25 <- univariat_sub_baetis(sub_25)
HS_sub_Baetis_28 <- univariat_sub_baetis(sub_28)
HS_sub_Baetis_32 <- univariat_sub_baetis(sub_32)

# Tanno 2012: Rhithrogena sp. -------------------------------------------
univariat_sub_rhithrogena <- function(x, y = sc_sub_Rhithrogena$Substrate.class, z = sc_sub_Rhithrogena$Abundance){
  calc(x, fun = approxfun(y, z, rule = 2))
}

# All Q's 
HS_sub_Rhithrogena_2 <- univariat_sub_rhithrogena(sub_2)
HS_sub_Rhithrogena_3 <- univariat_sub_rhithrogena(sub_3)
HS_sub_Rhithrogena_4 <- univariat_sub_rhithrogena(sub_4)
HS_sub_Rhithrogena_7 <- univariat_sub_rhithrogena(sub_7)
HS_sub_Rhithrogena_9 <- univariat_sub_rhithrogena(sub_9)
HS_sub_Rhithrogena_11 <- univariat_sub_rhithrogena(sub_11)
HS_sub_Rhithrogena_13 <- univariat_sub_rhithrogena(sub_13)
HS_sub_Rhithrogena_15 <- univariat_sub_rhithrogena(sub_15)
HS_sub_Rhithrogena_18 <- univariat_sub_rhithrogena(sub_18)
HS_sub_Rhithrogena_22 <- univariat_sub_rhithrogena(sub_22)
HS_sub_Rhithrogena_25 <- univariat_sub_rhithrogena(sub_25)
HS_sub_Rhithrogena_28 <- univariat_sub_rhithrogena(sub_28)
HS_sub_Rhithrogena_32 <- univariat_sub_rhithrogena(sub_32)

# Koordinatensystem (crs) -------------------------------------------
crs(HS_sub_Baetis_2) <- "+proj=longlat"
crs(HS_sub_Baetis_3) <- "+proj=longlat"
crs(HS_sub_Baetis_4) <- "+proj=longlat"
crs(HS_sub_Baetis_7) <- "+proj=longlat"
crs(HS_sub_Baetis_9) <- "+proj=longlat"
crs(HS_sub_Baetis_11) <- "+proj=longlat"
crs(HS_sub_Baetis_13) <- "+proj=longlat"
crs(HS_sub_Baetis_15) <- "+proj=longlat"
crs(HS_sub_Baetis_18) <- "+proj=longlat"
crs(HS_sub_Baetis_22) <- "+proj=longlat"
crs(HS_sub_Baetis_25) <- "+proj=longlat"
crs(HS_sub_Baetis_28) <- "+proj=longlat"
crs(HS_sub_Baetis_32) <- "+proj=longlat"

crs(HS_sub_Rhithrogena_2) <- "+proj=longlat"
crs(HS_sub_Rhithrogena_3) <- "+proj=longlat"
crs(HS_sub_Rhithrogena_4) <- "+proj=longlat"
crs(HS_sub_Rhithrogena_7) <- "+proj=longlat"
crs(HS_sub_Rhithrogena_9) <- "+proj=longlat"
crs(HS_sub_Rhithrogena_11) <- "+proj=longlat"
crs(HS_sub_Rhithrogena_13) <- "+proj=longlat"
crs(HS_sub_Rhithrogena_15) <- "+proj=longlat"
crs(HS_sub_Rhithrogena_18) <- "+proj=longlat"
crs(HS_sub_Rhithrogena_22) <- "+proj=longlat"
crs(HS_sub_Rhithrogena_25) <- "+proj=longlat"
crs(HS_sub_Rhithrogena_28) <- "+proj=longlat"
crs(HS_sub_Rhithrogena_32) <- "+proj=longlat"

# save as .tif -------------------------------------------
# Tanno 2012: Baetis sp. -------------------------------------------
writeRaster(HS_sub_Baetis_2, filename="results_univariate/HS_sub_Baetis_sp_winter_2.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_sub_Baetis_3, filename="results_univariate/HS_sub_Baetis_sp_winter_3.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_sub_Baetis_4, filename="results_univariate/HS_sub_Baetis_sp_winter_4.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_sub_Baetis_7, filename="results_univariate/HS_sub_Baetis_sp_winter_7.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_sub_Baetis_9, filename="results_univariate/HS_sub_Baetis_sp_winter_9.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_sub_Baetis_11, filename="results_univariate/HS_sub_Baetis_sp_winter_11.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_sub_Baetis_13, filename="results_univariate/HS_sub_Baetis_sp_winter_13.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_sub_Baetis_15, filename="results_univariate/HS_sub_Baetis_sp_winter_15.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_sub_Baetis_18, filename="results_univariate/HS_sub_Baetis_sp_winter_18.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_sub_Baetis_22, filename="results_univariate/HS_sub_Baetis_sp_winter_22.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_sub_Baetis_25, filename="results_univariate/HS_sub_Baetis_sp_winter_25.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_sub_Baetis_28, filename="results_univariate/HS_sub_Baetis_sp_winter_28.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_sub_Baetis_32, filename="results_univariate/HS_sub_Baetis_sp_winter_32.tif", format="GTiff", overwrite=TRUE)

# Tanno 2012: Rhithrogena sp. -------------------------------------------
writeRaster(HS_sub_Rhithrogena_2, filename="results_univariate/HS_sub_Rhithrogena_sp_winter_2.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_sub_Rhithrogena_3, filename="results_univariate/HS_sub_Rhithrogena_sp_winter_3.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_sub_Rhithrogena_4, filename="results_univariate/HS_sub_Rhithrogena_sp_winter_4.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_sub_Rhithrogena_7, filename="results_univariate/HS_sub_Rhithrogena_sp_winter_7.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_sub_Rhithrogena_9, filename="results_univariate/HS_sub_Rhithrogena_sp_winter_9.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_sub_Rhithrogena_11, filename="results_univariate/HS_sub_Rhithrogena_sp_winter_11.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_sub_Rhithrogena_13, filename="results_univariate/HS_sub_Rhithrogena_sp_winter_13.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_sub_Rhithrogena_15, filename="results_univariate/HS_sub_Rhithrogena_sp_winter_15.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_sub_Rhithrogena_18, filename="results_univariate/HS_sub_Rhithrogena_sp_winter_18.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_sub_Rhithrogena_22, filename="results_univariate/HS_sub_Rhithrogena_sp_winter_22.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_sub_Rhithrogena_25, filename="results_univariate/HS_sub_Rhithrogena_sp_winter_25.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_sub_Rhithrogena_28, filename="results_univariate/HS_sub_Rhithrogena_sp_winter_28.tif", format="GTiff", overwrite=TRUE)

writeRaster(HS_sub_Rhithrogena_32, filename="results_univariate/HS_sub_Rhithrogena_sp_winter_32.tif", format="GTiff", overwrite=TRUE)
```

## c. GHSI Habitateignungsindex
```{r}
### GHSI ###
# Tanno 2012 Rhithrogena -------------------------------------------
ghsi_3 <- function(x, y, z){
  overlay(x, y, z, 
          sub, fun = return(sqrt(x^3*y^3*z^3)))
}

# All Q's
GHSI_Tanno_2012_Rhithrogena_2 <- ghsi_3(HS_Tanno_2012_Rhithrogena_depth_2, HS_Tanno_2012_Rhithrogena_velocity_2, HS_sub_Rhithrogena_2)

GHSI_Tanno_2012_Rhithrogena_3 <- ghsi_3(HS_Tanno_2012_Rhithrogena_depth_3, HS_Tanno_2012_Rhithrogena_velocity_3, HS_sub_Rhithrogena_3)

GHSI_Tanno_2012_Rhithrogena_4 <- ghsi_3(HS_Tanno_2012_Rhithrogena_depth_4, HS_Tanno_2012_Rhithrogena_velocity_4, HS_sub_Rhithrogena_4)

GHSI_Tanno_2012_Rhithrogena_7 <- ghsi_3(HS_Tanno_2012_Rhithrogena_depth_7, HS_Tanno_2012_Rhithrogena_velocity_7, HS_sub_Rhithrogena_7)

GHSI_Tanno_2012_Rhithrogena_9 <- ghsi_3(HS_Tanno_2012_Rhithrogena_depth_9, HS_Tanno_2012_Rhithrogena_velocity_9, HS_sub_Rhithrogena_9)

GHSI_Tanno_2012_Rhithrogena_11 <- ghsi_3(HS_Tanno_2012_Rhithrogena_depth_11, HS_Tanno_2012_Rhithrogena_velocity_11, HS_sub_Rhithrogena_11)

GHSI_Tanno_2012_Rhithrogena_13 <- ghsi_3(HS_Tanno_2012_Rhithrogena_depth_13, HS_Tanno_2012_Rhithrogena_velocity_13, HS_sub_Rhithrogena_13)

GHSI_Tanno_2012_Rhithrogena_15 <- ghsi_3(HS_Tanno_2012_Rhithrogena_depth_15, HS_Tanno_2012_Rhithrogena_velocity_15, HS_sub_Rhithrogena_15)

GHSI_Tanno_2012_Rhithrogena_18 <- ghsi_3(HS_Tanno_2012_Rhithrogena_depth_18, HS_Tanno_2012_Rhithrogena_velocity_18, HS_sub_Rhithrogena_18)

GHSI_Tanno_2012_Rhithrogena_22 <- ghsi_3(HS_Tanno_2012_Rhithrogena_depth_22, HS_Tanno_2012_Rhithrogena_velocity_22, HS_sub_Rhithrogena_22)

GHSI_Tanno_2012_Rhithrogena_25 <- ghsi_3(HS_Tanno_2012_Rhithrogena_depth_25, HS_Tanno_2012_Rhithrogena_velocity_25, HS_sub_Rhithrogena_25)

GHSI_Tanno_2012_Rhithrogena_28 <- ghsi_3(HS_Tanno_2012_Rhithrogena_depth_28, HS_Tanno_2012_Rhithrogena_velocity_28, HS_sub_Rhithrogena_28)

GHSI_Tanno_2012_Rhithrogena_32 <- ghsi_3(HS_Tanno_2012_Rhithrogena_depth_32, HS_Tanno_2012_Rhithrogena_velocity_32, HS_sub_Rhithrogena_32)

# HABBY Rhithrogena -------------------------------------------
ghsi_2 <- function(x, y){
  overlay(x, y, 
          sub, fun = return(sqrt(x^2*y^2)))
}

# All Q's
GHSI_HABBY_Rhithrogena_2 <- ghsi_2(HS_HABBY_Rhithrogena_depth_2, HS_HABBY_Rhithrogena_velocity_2)
GHSI_HABBY_Rhithrogena_3 <- ghsi_2(HS_HABBY_Rhithrogena_depth_3, HS_HABBY_Rhithrogena_velocity_3)
GHSI_HABBY_Rhithrogena_4 <- ghsi_2(HS_HABBY_Rhithrogena_depth_4, HS_HABBY_Rhithrogena_velocity_4)
GHSI_HABBY_Rhithrogena_7 <- ghsi_2(HS_HABBY_Rhithrogena_depth_7, HS_HABBY_Rhithrogena_velocity_7)
GHSI_HABBY_Rhithrogena_9 <- ghsi_2(HS_HABBY_Rhithrogena_depth_9, HS_HABBY_Rhithrogena_velocity_9)
GHSI_HABBY_Rhithrogena_11 <- ghsi_2(HS_HABBY_Rhithrogena_depth_11, HS_HABBY_Rhithrogena_velocity_11)
GHSI_HABBY_Rhithrogena_13 <- ghsi_2(HS_HABBY_Rhithrogena_depth_13, HS_HABBY_Rhithrogena_velocity_13)
GHSI_HABBY_Rhithrogena_15 <- ghsi_2(HS_HABBY_Rhithrogena_depth_15, HS_HABBY_Rhithrogena_velocity_15)
GHSI_HABBY_Rhithrogena_18 <- ghsi_2(HS_HABBY_Rhithrogena_depth_18, HS_HABBY_Rhithrogena_velocity_18)
GHSI_HABBY_Rhithrogena_22 <- ghsi_2(HS_HABBY_Rhithrogena_depth_22, HS_HABBY_Rhithrogena_velocity_22)
GHSI_HABBY_Rhithrogena_25 <- ghsi_2(HS_HABBY_Rhithrogena_depth_25, HS_HABBY_Rhithrogena_velocity_25)
GHSI_HABBY_Rhithrogena_28 <- ghsi_2(HS_HABBY_Rhithrogena_depth_28, HS_HABBY_Rhithrogena_velocity_28)
GHSI_HABBY_Rhithrogena_32 <- ghsi_2(HS_HABBY_Rhithrogena_depth_32, HS_HABBY_Rhithrogena_velocity_32)


# Tanno 2012 Baetis (+ sub) -------------------------------------------
# All Q's
GHSI_Tanno_2012_Baetis_2 <- ghsi_3(HS_Tanno_2012_Baetis_depth_2, HS_Tanno_2012_Baetis_velocity_2, HS_sub_Baetis_2)

GHSI_Tanno_2012_Baetis_3 <- ghsi_3(HS_Tanno_2012_Baetis_depth_3, HS_Tanno_2012_Baetis_velocity_3, HS_sub_Baetis_3)

GHSI_Tanno_2012_Baetis_4 <- ghsi_3(HS_Tanno_2012_Baetis_depth_4, HS_Tanno_2012_Baetis_velocity_4, HS_sub_Baetis_4)

GHSI_Tanno_2012_Baetis_7 <- ghsi_3(HS_Tanno_2012_Baetis_depth_7, HS_Tanno_2012_Baetis_velocity_7, HS_sub_Baetis_7)

GHSI_Tanno_2012_Baetis_9 <- ghsi_3(HS_Tanno_2012_Baetis_depth_9, HS_Tanno_2012_Baetis_velocity_9, HS_sub_Baetis_9)

GHSI_Tanno_2012_Baetis_11 <- ghsi_3(HS_Tanno_2012_Baetis_depth_11, HS_Tanno_2012_Baetis_velocity_11, HS_sub_Baetis_11)

GHSI_Tanno_2012_Baetis_13 <- ghsi_3(HS_Tanno_2012_Baetis_depth_13, HS_Tanno_2012_Baetis_velocity_13, HS_sub_Baetis_13)

GHSI_Tanno_2012_Baetis_15 <- ghsi_3(HS_Tanno_2012_Baetis_depth_15, HS_Tanno_2012_Baetis_velocity_15, HS_sub_Baetis_15)

GHSI_Tanno_2012_Baetis_18 <- ghsi_3(HS_Tanno_2012_Baetis_depth_18, HS_Tanno_2012_Baetis_velocity_18, HS_sub_Baetis_18)

GHSI_Tanno_2012_Baetis_22 <- ghsi_3(HS_Tanno_2012_Baetis_depth_22, HS_Tanno_2012_Baetis_velocity_22, HS_sub_Baetis_22)

GHSI_Tanno_2012_Baetis_25 <- ghsi_3(HS_Tanno_2012_Baetis_depth_25, HS_Tanno_2012_Baetis_velocity_25, HS_sub_Baetis_25)

GHSI_Tanno_2012_Baetis_28 <- ghsi_3(HS_Tanno_2012_Baetis_depth_28, HS_Tanno_2012_Baetis_velocity_28, HS_sub_Baetis_28)

GHSI_Tanno_2012_Baetis_32 <- ghsi_3(HS_Tanno_2012_Baetis_depth_32, HS_Tanno_2012_Baetis_velocity_32, HS_sub_Baetis_32)

# save as .tif -------------------------------------------
# Tanno 2012: Rhithrogena -------------------------------------------
writeRaster(GHSI_Tanno_2012_Rhithrogena_2, filename="results_multivariate/GHSI_Tanno_2012_Rhithrogena_sp_winter_2.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_Tanno_2012_Rhithrogena_3, filename="results_multivariate/GHSI_Tanno_2012_Rhithrogena_sp_winter_3.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_Tanno_2012_Rhithrogena_4, filename="results_multivariate/GHSI_Tanno_2012_Rhithrogena_sp_winter_4.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_Tanno_2012_Rhithrogena_7, filename="results_multivariate/GHSI_Tanno_2012_Rhithrogena_sp_winter_7.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_Tanno_2012_Rhithrogena_9, filename="results_multivariate/GHSI_Tanno_2012_Rhithrogena_sp_winter_9.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_Tanno_2012_Rhithrogena_11, filename="results_multivariate/GHSI_Tanno_2012_Rhithrogena_sp_winter_11.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_Tanno_2012_Rhithrogena_13, filename="results_multivariate/GHSI_Tanno_2012_Rhithrogena_sp_winter_13.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_Tanno_2012_Rhithrogena_15, filename="results_multivariate/GHSI_Tanno_2012_Rhithrogena_sp_winter_15.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_Tanno_2012_Rhithrogena_18, filename="results_multivariate/GHSI_Tanno_2012_Rhithrogena_sp_winter_18.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_Tanno_2012_Rhithrogena_22, filename="results_multivariate/GHSI_Tanno_2012_Rhithrogena_sp_winter_22.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_Tanno_2012_Rhithrogena_25, filename="results_multivariate/GHSI_Tanno_2012_Rhithrogena_sp_winter_25.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_Tanno_2012_Rhithrogena_28, filename="results_multivariate/GHSI_Tanno_2012_Rhithrogena_sp_winter_28.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_Tanno_2012_Rhithrogena_32, filename="results_multivariate/GHSI_Tanno_2012_Rhithrogena_sp_winter_32.tif", format="GTiff", overwrite=TRUE)

# HABBY Rhithrogena -------------------------------------------
writeRaster(GHSI_HABBY_Rhithrogena_2, filename="results_multivariate/GHSI_HABBY_Rhithrogena_eaton_larva_2.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_HABBY_Rhithrogena_3, filename="results_multivariate/GHSI_HABBY_Rhithrogena_eaton_larva_3.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_HABBY_Rhithrogena_4, filename="results_multivariate/GHSI_HABBY_Rhithrogena_eaton_larva_4.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_HABBY_Rhithrogena_7, filename="results_multivariate/GHSI_HABBY_Rhithrogena_eaton_larva_7.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_HABBY_Rhithrogena_9, filename="results_multivariate/GHSI_HABBY_Rhithrogena_eaton_larva_9.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_HABBY_Rhithrogena_11, filename="results_multivariate/GHSI_HABBY_Rhithrogena_eaton_larva_11.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_HABBY_Rhithrogena_13, filename="results_multivariate/GHSI_HABBY_Rhithrogena_eaton_larva_13.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_HABBY_Rhithrogena_15, filename="results_multivariate/GHSI_HABBY_Rhithrogena_eaton_larva_15.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_HABBY_Rhithrogena_18, filename="results_multivariate/GHSI_HABBY_Rhithrogena_eaton_larva_18.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_HABBY_Rhithrogena_22, filename="results_multivariate/GHSI_HABBY_Rhithrogena_eaton_larva_22.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_HABBY_Rhithrogena_25, filename="results_multivariate/GHSI_HABBY_Rhithrogena_eaton_larva_25.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_HABBY_Rhithrogena_28, filename="results_multivariate/GHSI_HABBY_Rhithrogena_eaton_larva_28.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_HABBY_Rhithrogena_32, filename="results_multivariate/GHSI_HABBY_Rhithrogena_eaton_larva_32.tif", format="GTiff", overwrite=TRUE)

# Tanno 2012 Baetis sp. -------------------------------------------
writeRaster(GHSI_Tanno_2012_Baetis_2, filename="results_multivariate/GHSI_Tanno_2012_Baetis_sp_winter_2.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_Tanno_2012_Baetis_3, filename="results_multivariate/GHSI_Tanno_2012_Baetis_sp_winter_3.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_Tanno_2012_Baetis_4, filename="results_multivariate/GHSI_Tanno_2012_Baetis_sp_winter_4.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_Tanno_2012_Baetis_7, filename="results_multivariate/GHSI_Tanno_2012_Baetis_sp_winter_7.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_Tanno_2012_Baetis_9, filename="results_multivariate/GHSI_Tanno_2012_Baetis_sp_winter_9.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_Tanno_2012_Baetis_11, filename="results_multivariate/GHSI_Tanno_2012_Baetis_sp_winter_11.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_Tanno_2012_Baetis_13, filename="results_multivariate/GHSI_Tanno_2012_Baetis_sp_winter_13.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_Tanno_2012_Baetis_15, filename="results_multivariate/GHSI_Tanno_2012_Baetis_sp_winter_15.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_Tanno_2012_Baetis_18, filename="results_multivariate/GHSI_Tanno_2012_Baetis_sp_winter_18.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_Tanno_2012_Baetis_22, filename="results_multivariate/GHSI_Tanno_2012_Baetis_sp_winter_22.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_Tanno_2012_Baetis_25, filename="results_multivariate/GHSI_Tanno_2012_Baetis_sp_winter_25.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_Tanno_2012_Baetis_28, filename="results_multivariate/GHSI_Tanno_2012_Baetis_sp_winter_28.tif", format="GTiff", overwrite=TRUE)

writeRaster(GHSI_Tanno_2012_Baetis_32, filename="results_multivariate/GHSI_Tanno_2012_Baetis_sp_winter_32.tif", format="GTiff", overwrite=TRUE)
```

## * Persistent Habitats GHSI
```{r}
# Clip the raster1 with raster2
# Tanno 2012 Rhithrogena -------------------------------------------
persistent_tanno_2012_rhithrogena_2 <- mask(GHSI_Tanno_2012_Rhithrogena_2, GHSI_Tanno_2012_Rhithrogena_2)

persistent_tanno_2012_rhithrogena_3 <- mask(GHSI_Tanno_2012_Rhithrogena_3, GHSI_Tanno_2012_Rhithrogena_2)

persistent_tanno_2012_rhithrogena_4 <- mask(GHSI_Tanno_2012_Rhithrogena_4, GHSI_Tanno_2012_Rhithrogena_2)

persistent_tanno_2012_rhithrogena_7 <- mask(GHSI_Tanno_2012_Rhithrogena_7, GHSI_Tanno_2012_Rhithrogena_2)

persistent_tanno_2012_rhithrogena_9 <- mask(GHSI_Tanno_2012_Rhithrogena_9, GHSI_Tanno_2012_Rhithrogena_2)

persistent_tanno_2012_rhithrogena_11 <- mask(GHSI_Tanno_2012_Rhithrogena_11, GHSI_Tanno_2012_Rhithrogena_2)

persistent_tanno_2012_rhithrogena_13 <- mask(GHSI_Tanno_2012_Rhithrogena_13, GHSI_Tanno_2012_Rhithrogena_2)

persistent_tanno_2012_rhithrogena_15 <- mask(GHSI_Tanno_2012_Rhithrogena_15, GHSI_Tanno_2012_Rhithrogena_2)

persistent_tanno_2012_rhithrogena_18 <- mask(GHSI_Tanno_2012_Rhithrogena_18, GHSI_Tanno_2012_Rhithrogena_2)

persistent_tanno_2012_rhithrogena_22 <- mask(GHSI_Tanno_2012_Rhithrogena_22, GHSI_Tanno_2012_Rhithrogena_2)

persistent_tanno_2012_rhithrogena_25 <- mask(GHSI_Tanno_2012_Rhithrogena_25, GHSI_Tanno_2012_Rhithrogena_2)

persistent_tanno_2012_rhithrogena_28 <- mask(GHSI_Tanno_2012_Rhithrogena_28, GHSI_Tanno_2012_Rhithrogena_2)

persistent_tanno_2012_rhithrogena_32 <- mask(GHSI_Tanno_2012_Rhithrogena_32, GHSI_Tanno_2012_Rhithrogena_2)

# HABBY Rhithrogena -------------------------------------------
persistent_habby_rhithrogena_2 <- mask(GHSI_HABBY_Rhithrogena_2, GHSI_HABBY_Rhithrogena_2)

persistent_habby_rhithrogena_3 <- mask(GHSI_HABBY_Rhithrogena_3, GHSI_HABBY_Rhithrogena_2)

persistent_habby_rhithrogena_4 <- mask(GHSI_HABBY_Rhithrogena_4, GHSI_HABBY_Rhithrogena_2)

persistent_habby_rhithrogena_7 <- mask(GHSI_HABBY_Rhithrogena_7, GHSI_HABBY_Rhithrogena_2)

persistent_habby_rhithrogena_9 <- mask(GHSI_HABBY_Rhithrogena_9, GHSI_HABBY_Rhithrogena_2)

persistent_habby_rhithrogena_11 <- mask(GHSI_HABBY_Rhithrogena_11, GHSI_HABBY_Rhithrogena_2)

persistent_habby_rhithrogena_13 <- mask(GHSI_HABBY_Rhithrogena_13, GHSI_HABBY_Rhithrogena_2)

persistent_habby_rhithrogena_15 <- mask(GHSI_HABBY_Rhithrogena_15, GHSI_HABBY_Rhithrogena_2)

persistent_habby_rhithrogena_18 <- mask(GHSI_HABBY_Rhithrogena_18, GHSI_HABBY_Rhithrogena_2)

persistent_habby_rhithrogena_22 <- mask(GHSI_HABBY_Rhithrogena_22, GHSI_HABBY_Rhithrogena_2)

persistent_habby_rhithrogena_25 <- mask(GHSI_HABBY_Rhithrogena_25, GHSI_HABBY_Rhithrogena_2)

persistent_habby_rhithrogena_28 <- mask(GHSI_HABBY_Rhithrogena_28, GHSI_HABBY_Rhithrogena_2)

persistent_habby_rhithrogena_32 <- mask(GHSI_HABBY_Rhithrogena_32, GHSI_HABBY_Rhithrogena_2)

# Tanno 2012 Baetis sp. -------------------------------------------
persistent_tanno_2012_baetis_2 <- mask(GHSI_Tanno_2012_Baetis_2, GHSI_Tanno_2012_Baetis_2)

persistent_tanno_2012_baetis_3 <- mask(GHSI_Tanno_2012_Baetis_3, GHSI_Tanno_2012_Baetis_2)

persistent_tanno_2012_baetis_4 <- mask(GHSI_Tanno_2012_Baetis_4, GHSI_Tanno_2012_Baetis_2)

persistent_tanno_2012_baetis_7 <- mask(GHSI_Tanno_2012_Baetis_7, GHSI_Tanno_2012_Baetis_2)

persistent_tanno_2012_baetis_9 <- mask(GHSI_Tanno_2012_Baetis_9, GHSI_Tanno_2012_Baetis_2)

persistent_tanno_2012_baetis_11 <- mask(GHSI_Tanno_2012_Baetis_11, GHSI_Tanno_2012_Baetis_2)

persistent_tanno_2012_baetis_13 <- mask(GHSI_Tanno_2012_Baetis_13, GHSI_Tanno_2012_Baetis_2)

persistent_tanno_2012_baetis_15 <- mask(GHSI_Tanno_2012_Baetis_15, GHSI_Tanno_2012_Baetis_2)

persistent_tanno_2012_baetis_18 <- mask(GHSI_Tanno_2012_Baetis_18, GHSI_Tanno_2012_Baetis_2)

persistent_tanno_2012_baetis_22 <- mask(GHSI_Tanno_2012_Baetis_22, GHSI_Tanno_2012_Baetis_2)

persistent_tanno_2012_baetis_25 <- mask(GHSI_Tanno_2012_Baetis_25, GHSI_Tanno_2012_Baetis_2)

persistent_tanno_2012_baetis_28 <- mask(GHSI_Tanno_2012_Baetis_28, GHSI_Tanno_2012_Baetis_2)

persistent_tanno_2012_baetis_32 <- mask(GHSI_Tanno_2012_Baetis_32, GHSI_Tanno_2012_Baetis_2)

# Save the clipped raster-files as a new file -------------------------
# Tanno 2012 Rhithrogena -------------------------------------------
writeRaster(persistent_tanno_2012_rhithrogena_2, filename="results_multivariate/persistent_rhithrogena_tanno_2012_2.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_tanno_2012_rhithrogena_3, filename="results_multivariate/persistent_rhithrogena_tanno_2012_3.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_tanno_2012_rhithrogena_4, filename="results_multivariate/persistent_rhithrogena_tanno_2012_4.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_tanno_2012_rhithrogena_7, filename="results_multivariate/persistent_rhithrogena_tanno_2012_7.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_tanno_2012_rhithrogena_9, filename="results_multivariate/persistent_rhithrogena_tanno_2012_9.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_tanno_2012_rhithrogena_11, filename="results_multivariate/persistent_rhithrogena_tanno_2012_11.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_tanno_2012_rhithrogena_13, filename="results_multivariate/persistent_rhithrogena_tanno_2012_13.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_tanno_2012_rhithrogena_15, filename="results_multivariate/persistent_rhithrogena_tanno_2012_15.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_tanno_2012_rhithrogena_18, filename="results_multivariate/persistent_rhithrogena_tanno_2012_18.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_tanno_2012_rhithrogena_22, filename="results_multivariate/persistent_rhithrogena_tanno_2012_22.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_tanno_2012_rhithrogena_25, filename="results_multivariate/persistent_rhithrogena_tanno_2012_25.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_tanno_2012_rhithrogena_28, filename="results_multivariate/persistent_rhithrogena_tanno_2012_28.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_tanno_2012_rhithrogena_32, filename="results_multivariate/persistent_rhithrogena_tanno_2012_32.tif", format="GTiff", overwrite = TRUE)

# HABBY Rhithrogena -------------------------------------------
writeRaster(persistent_habby_rhithrogena_2, filename="results_multivariate/persistent_rhithrogena_habby_2.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_habby_rhithrogena_3, filename="results_multivariate/persistent_rhithrogena_habby_3.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_habby_rhithrogena_4, filename="results_multivariate/persistent_rhithrogena_habby_4.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_habby_rhithrogena_7, filename="results_multivariate/persistent_rhithrogena_habby_7.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_habby_rhithrogena_9, filename="results_multivariate/persistent_rhithrogena_habby_9.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_habby_rhithrogena_11, filename="results_multivariate/persistent_rhithrogena_habby_11.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_habby_rhithrogena_13, filename="results_multivariate/persistent_rhithrogena_habby_13.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_habby_rhithrogena_15, filename="results_multivariate/persistent_rhithrogena_habby_15.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_habby_rhithrogena_18, filename="results_multivariate/persistent_rhithrogena_habby_18.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_habby_rhithrogena_22, filename="results_multivariate/persistent_rhithrogena_habby_22.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_habby_rhithrogena_25, filename="results_multivariate/persistent_rhithrogena_habby_25.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_habby_rhithrogena_28, filename="results_multivariate/persistent_rhithrogena_habby_28.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_habby_rhithrogena_32, filename="results_multivariate/persistent_rhithrogena_habby_32.tif", format="GTiff", overwrite = TRUE)

# Tanno 2012 Baetis sp. -------------------------------------------
writeRaster(persistent_tanno_2012_baetis_2, filename="results_multivariate/persistent_baetis_tanno_2012_2.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_tanno_2012_baetis_3, filename="results_multivariate/persistent_baetis_tanno_2012_3.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_tanno_2012_baetis_4, filename="results_multivariate/persistent_baetis_tanno_2012_4.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_tanno_2012_baetis_7, filename="results_multivariate/persistent_baetis_tanno_2012_7.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_tanno_2012_baetis_9, filename="results_multivariate/persistent_baetis_tanno_2012_9.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_tanno_2012_baetis_11, filename="results_multivariate/persistent_baetis_tanno_2012_11.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_tanno_2012_baetis_13, filename="results_multivariate/persistent_baetis_tanno_2012_13.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_tanno_2012_baetis_15, filename="results_multivariate/persistent_baetis_tanno_2012_15.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_tanno_2012_baetis_18, filename="results_multivariate/persistent_baetis_tanno_2012_18.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_tanno_2012_baetis_22, filename="results_multivariate/persistent_baetis_tanno_2012_22.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_tanno_2012_baetis_25, filename="results_multivariate/persistent_baetis_tanno_2012_25.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_tanno_2012_baetis_28, filename="results_multivariate/persistent_baetis_tanno_2012_28.tif", format="GTiff", overwrite = TRUE)

writeRaster(persistent_tanno_2012_baetis_32, filename="results_multivariate/persistent_baetis_tanno_2012_32.tif", format="GTiff", overwrite = TRUE)
```

### c1. frequency tables
```{r}
# Erstelle Haeufigkeitstabelle 
# Tanno 2012: Rhithrogena -------------------------------------------
freq_table <- function(x){
 as.data.frame(freq(x, digit=1, useNA= "no"))
}

# All Q's
freq_GHSI_Tanno_2012_Rhithrogena_2 <- freq_table(GHSI_Tanno_2012_Rhithrogena_2)
freq_GHSI_Tanno_2012_Rhithrogena_3 <- freq_table(GHSI_Tanno_2012_Rhithrogena_3)
freq_GHSI_Tanno_2012_Rhithrogena_4 <- freq_table(GHSI_Tanno_2012_Rhithrogena_4)
freq_GHSI_Tanno_2012_Rhithrogena_7 <- freq_table(GHSI_Tanno_2012_Rhithrogena_7)
freq_GHSI_Tanno_2012_Rhithrogena_9 <- freq_table(GHSI_Tanno_2012_Rhithrogena_9)
freq_GHSI_Tanno_2012_Rhithrogena_11 <- freq_table(GHSI_Tanno_2012_Rhithrogena_11)
freq_GHSI_Tanno_2012_Rhithrogena_13 <- freq_table(GHSI_Tanno_2012_Rhithrogena_13)
freq_GHSI_Tanno_2012_Rhithrogena_15 <- freq_table(GHSI_Tanno_2012_Rhithrogena_15)
freq_GHSI_Tanno_2012_Rhithrogena_18 <- freq_table(GHSI_Tanno_2012_Rhithrogena_18)
freq_GHSI_Tanno_2012_Rhithrogena_22 <- freq_table(GHSI_Tanno_2012_Rhithrogena_22)
freq_GHSI_Tanno_2012_Rhithrogena_25 <- freq_table(GHSI_Tanno_2012_Rhithrogena_25)
freq_GHSI_Tanno_2012_Rhithrogena_28 <- freq_table(GHSI_Tanno_2012_Rhithrogena_28)
freq_GHSI_Tanno_2012_Rhithrogena_32 <- freq_table(GHSI_Tanno_2012_Rhithrogena_32)

# HABBY Rhithrogena -------------------------------------------
# All Q's
freq_GHSI_HABBY_Rhithrogena_2 <- freq_table(GHSI_HABBY_Rhithrogena_2)
freq_GHSI_HABBY_Rhithrogena_3 <- freq_table(GHSI_HABBY_Rhithrogena_3)
freq_GHSI_HABBY_Rhithrogena_4 <- freq_table(GHSI_HABBY_Rhithrogena_4)
freq_GHSI_HABBY_Rhithrogena_7 <- freq_table(GHSI_HABBY_Rhithrogena_7)
freq_GHSI_HABBY_Rhithrogena_9 <- freq_table(GHSI_HABBY_Rhithrogena_9)
freq_GHSI_HABBY_Rhithrogena_11 <- freq_table(GHSI_HABBY_Rhithrogena_11)
freq_GHSI_HABBY_Rhithrogena_13 <- freq_table(GHSI_HABBY_Rhithrogena_13)
freq_GHSI_HABBY_Rhithrogena_15 <- freq_table(GHSI_HABBY_Rhithrogena_15)
freq_GHSI_HABBY_Rhithrogena_18 <- freq_table(GHSI_HABBY_Rhithrogena_18)
freq_GHSI_HABBY_Rhithrogena_22 <- freq_table(GHSI_HABBY_Rhithrogena_22)
freq_GHSI_HABBY_Rhithrogena_25 <- freq_table(GHSI_HABBY_Rhithrogena_25)
freq_GHSI_HABBY_Rhithrogena_28 <- freq_table(GHSI_HABBY_Rhithrogena_28)
freq_GHSI_HABBY_Rhithrogena_32 <- freq_table(GHSI_HABBY_Rhithrogena_32)

# Tanno 2012 Baetis sp. -------------------------------------------
# All Q's
freq_GHSI_Tanno_2012_Baetis_2 <- freq_table(GHSI_Tanno_2012_Baetis_2)
freq_GHSI_Tanno_2012_Baetis_3 <- freq_table(GHSI_Tanno_2012_Baetis_3)
freq_GHSI_Tanno_2012_Baetis_4 <- freq_table(GHSI_Tanno_2012_Baetis_4)
freq_GHSI_Tanno_2012_Baetis_7 <- freq_table(GHSI_Tanno_2012_Baetis_7)
freq_GHSI_Tanno_2012_Baetis_9 <- freq_table(GHSI_Tanno_2012_Baetis_9)
freq_GHSI_Tanno_2012_Baetis_11 <- freq_table(GHSI_Tanno_2012_Baetis_11)
freq_GHSI_Tanno_2012_Baetis_13 <- freq_table(GHSI_Tanno_2012_Baetis_13)
freq_GHSI_Tanno_2012_Baetis_15 <- freq_table(GHSI_Tanno_2012_Baetis_15)
freq_GHSI_Tanno_2012_Baetis_18 <- freq_table(GHSI_Tanno_2012_Baetis_18)
freq_GHSI_Tanno_2012_Baetis_22 <- freq_table(GHSI_Tanno_2012_Baetis_22)
freq_GHSI_Tanno_2012_Baetis_25 <- freq_table(GHSI_Tanno_2012_Baetis_25)
freq_GHSI_Tanno_2012_Baetis_28 <- freq_table(GHSI_Tanno_2012_Baetis_28)
freq_GHSI_Tanno_2012_Baetis_32 <- freq_table(GHSI_Tanno_2012_Baetis_32)
```


## e. Weigthed Usable Area normal [m2]
```{r}
# define function for WUA calculation -----------------------------------
wua <- function(x){
  cellStats(x, 'sum') * 4
}

# calculate WUA for all Q's -----------------------------------
# Tanno 2012: Rhithrogena -------------------------------------------
WUA_Tanno_2012_Rhithrogena_2 <- wua(GHSI_Tanno_2012_Rhithrogena_2)
WUA_Tanno_2012_Rhithrogena_3 <- wua(GHSI_Tanno_2012_Rhithrogena_3)
WUA_Tanno_2012_Rhithrogena_4 <- wua(GHSI_Tanno_2012_Rhithrogena_4)
WUA_Tanno_2012_Rhithrogena_7 <- wua(GHSI_Tanno_2012_Rhithrogena_7)
WUA_Tanno_2012_Rhithrogena_9 <- wua(GHSI_Tanno_2012_Rhithrogena_9)
WUA_Tanno_2012_Rhithrogena_11 <- wua(GHSI_Tanno_2012_Rhithrogena_11)
WUA_Tanno_2012_Rhithrogena_13 <- wua(GHSI_Tanno_2012_Rhithrogena_13)
WUA_Tanno_2012_Rhithrogena_15 <- wua(GHSI_Tanno_2012_Rhithrogena_15)
WUA_Tanno_2012_Rhithrogena_18 <- wua(GHSI_Tanno_2012_Rhithrogena_18)
WUA_Tanno_2012_Rhithrogena_22 <- wua(GHSI_Tanno_2012_Rhithrogena_22)
WUA_Tanno_2012_Rhithrogena_25 <- wua(GHSI_Tanno_2012_Rhithrogena_25)
WUA_Tanno_2012_Rhithrogena_28 <- wua(GHSI_Tanno_2012_Rhithrogena_28)
WUA_Tanno_2012_Rhithrogena_32 <- wua(GHSI_Tanno_2012_Rhithrogena_32)

# HABBY Rhithrogena -------------------------------------------
WUA_HABBY_Rhithrogena_2 <- wua(GHSI_HABBY_Rhithrogena_2)
WUA_HABBY_Rhithrogena_3 <- wua(GHSI_HABBY_Rhithrogena_3)
WUA_HABBY_Rhithrogena_4 <- wua(GHSI_HABBY_Rhithrogena_4)
WUA_HABBY_Rhithrogena_7 <- wua(GHSI_HABBY_Rhithrogena_7)
WUA_HABBY_Rhithrogena_9 <- wua(GHSI_HABBY_Rhithrogena_9)
WUA_HABBY_Rhithrogena_11 <- wua(GHSI_HABBY_Rhithrogena_11)
WUA_HABBY_Rhithrogena_13 <- wua(GHSI_HABBY_Rhithrogena_13)
WUA_HABBY_Rhithrogena_15 <- wua(GHSI_HABBY_Rhithrogena_15)
WUA_HABBY_Rhithrogena_18 <- wua(GHSI_HABBY_Rhithrogena_18)
WUA_HABBY_Rhithrogena_22 <- wua(GHSI_HABBY_Rhithrogena_22)
WUA_HABBY_Rhithrogena_25 <- wua(GHSI_HABBY_Rhithrogena_25)
WUA_HABBY_Rhithrogena_28 <- wua(GHSI_HABBY_Rhithrogena_28)
WUA_HABBY_Rhithrogena_32 <- wua(GHSI_HABBY_Rhithrogena_32)

# Tanno 2012: Baetis sp. -------------------------------------------
WUA_Tanno_2012_Baetis_2 <- wua(GHSI_Tanno_2012_Baetis_2)
WUA_Tanno_2012_Baetis_3 <- wua(GHSI_Tanno_2012_Baetis_3)
WUA_Tanno_2012_Baetis_4 <- wua(GHSI_Tanno_2012_Baetis_4)
WUA_Tanno_2012_Baetis_7 <- wua(GHSI_Tanno_2012_Baetis_7)
WUA_Tanno_2012_Baetis_9 <- wua(GHSI_Tanno_2012_Baetis_9)
WUA_Tanno_2012_Baetis_11 <- wua(GHSI_Tanno_2012_Baetis_11)
WUA_Tanno_2012_Baetis_13 <- wua(GHSI_Tanno_2012_Baetis_13)
WUA_Tanno_2012_Baetis_15 <- wua(GHSI_Tanno_2012_Baetis_15)
WUA_Tanno_2012_Baetis_18 <- wua(GHSI_Tanno_2012_Baetis_18)
WUA_Tanno_2012_Baetis_22 <- wua(GHSI_Tanno_2012_Baetis_22)
WUA_Tanno_2012_Baetis_25 <- wua(GHSI_Tanno_2012_Baetis_25)
WUA_Tanno_2012_Baetis_28 <- wua(GHSI_Tanno_2012_Baetis_28)
WUA_Tanno_2012_Baetis_32 <- wua(GHSI_Tanno_2012_Baetis_32)
```

## e. Weigthed Usable Area GHSI persistent [m2]
```{r}
# calculate WUA for all Q's -----------------------------------
# Tanno 2012: Rhithrogena -------------------------------------------
WUA_pers_Tanno_2012_Rhithrogena_2 <- wua(persistent_tanno_2012_rhithrogena_2)
WUA_pers_Tanno_2012_Rhithrogena_3 <- wua(persistent_tanno_2012_rhithrogena_3)
WUA_pers_Tanno_2012_Rhithrogena_4 <- wua(persistent_tanno_2012_rhithrogena_4)
WUA_pers_Tanno_2012_Rhithrogena_7 <- wua(persistent_tanno_2012_rhithrogena_7)
WUA_pers_Tanno_2012_Rhithrogena_9 <- wua(persistent_tanno_2012_rhithrogena_9)
WUA_pers_Tanno_2012_Rhithrogena_11 <- wua(persistent_tanno_2012_rhithrogena_11)
WUA_pers_Tanno_2012_Rhithrogena_13 <- wua(persistent_tanno_2012_rhithrogena_13)
WUA_pers_Tanno_2012_Rhithrogena_15 <- wua(persistent_tanno_2012_rhithrogena_15)
WUA_pers_Tanno_2012_Rhithrogena_18 <- wua(persistent_tanno_2012_rhithrogena_18)
WUA_pers_Tanno_2012_Rhithrogena_22 <- wua(persistent_tanno_2012_rhithrogena_22)
WUA_pers_Tanno_2012_Rhithrogena_25 <- wua(persistent_tanno_2012_rhithrogena_25)
WUA_pers_Tanno_2012_Rhithrogena_28 <- wua(persistent_tanno_2012_rhithrogena_28)
WUA_pers_Tanno_2012_Rhithrogena_32 <- wua(persistent_tanno_2012_rhithrogena_32)

# HABBY Rhithrogena -------------------------------------------
WUA_pers_HABBY_Rhithrogena_2 <- wua(persistent_habby_rhithrogena_2)
WUA_pers_HABBY_Rhithrogena_3 <- wua(persistent_habby_rhithrogena_3)
WUA_pers_HABBY_Rhithrogena_4 <- wua(persistent_habby_rhithrogena_4)
WUA_pers_HABBY_Rhithrogena_7 <- wua(persistent_habby_rhithrogena_7)
WUA_pers_HABBY_Rhithrogena_9 <- wua(persistent_habby_rhithrogena_9)
WUA_pers_HABBY_Rhithrogena_11 <- wua(persistent_habby_rhithrogena_11)
WUA_pers_HABBY_Rhithrogena_13 <- wua(persistent_habby_rhithrogena_13)
WUA_pers_HABBY_Rhithrogena_15 <- wua(persistent_habby_rhithrogena_15)
WUA_pers_HABBY_Rhithrogena_18 <- wua(persistent_habby_rhithrogena_18)
WUA_pers_HABBY_Rhithrogena_22 <- wua(persistent_habby_rhithrogena_22)
WUA_pers_HABBY_Rhithrogena_25 <- wua(persistent_habby_rhithrogena_25)
WUA_pers_HABBY_Rhithrogena_28 <- wua(persistent_habby_rhithrogena_28)
WUA_pers_HABBY_Rhithrogena_32 <- wua(persistent_habby_rhithrogena_32)

# Tanno 2012: Baetis sp. -------------------------------------------
WUA_pers_Tanno_2012_Baetis_2 <- wua(persistent_tanno_2012_baetis_2)
WUA_pers_Tanno_2012_Baetis_3 <- wua(persistent_tanno_2012_baetis_3)
WUA_pers_Tanno_2012_Baetis_4 <- wua(persistent_tanno_2012_baetis_4)
WUA_pers_Tanno_2012_Baetis_7 <- wua(persistent_tanno_2012_baetis_7)
WUA_pers_Tanno_2012_Baetis_9 <- wua(persistent_tanno_2012_baetis_9)
WUA_pers_Tanno_2012_Baetis_11 <- wua(persistent_tanno_2012_baetis_11)
WUA_pers_Tanno_2012_Baetis_13 <- wua(persistent_tanno_2012_baetis_13)
WUA_pers_Tanno_2012_Baetis_15 <- wua(persistent_tanno_2012_baetis_15)
WUA_pers_Tanno_2012_Baetis_18 <- wua(persistent_tanno_2012_baetis_18)
WUA_pers_Tanno_2012_Baetis_22 <- wua(persistent_tanno_2012_baetis_22)
WUA_pers_Tanno_2012_Baetis_25 <- wua(persistent_tanno_2012_baetis_25)
WUA_pers_Tanno_2012_Baetis_28 <- wua(persistent_tanno_2012_baetis_28)
WUA_pers_Tanno_2012_Baetis_32 <- wua(persistent_tanno_2012_baetis_32)
```

## e. Weigthed Usable Area velocity persistent [m2]
```{r}
# calculate WUA for all Q's -----------------------------------
# Tanno 2012: Rhithrogena -------------------------------------------
wua_v_pers_tanno_rhith_2 <- wua(v_tanno_2012_rhith_pers_2)
wua_v_pers_tanno_rhith_3 <- wua(v_tanno_2012_rhith_pers_3)
wua_v_pers_tanno_rhith_4 <- wua(v_tanno_2012_rhith_pers_4)
wua_v_pers_tanno_rhith_7 <- wua(v_tanno_2012_rhith_pers_7)
wua_v_pers_tanno_rhith_9 <- wua(v_tanno_2012_rhith_pers_9)
wua_v_pers_tanno_rhith_11 <- wua(v_tanno_2012_rhith_pers_11)
wua_v_pers_tanno_rhith_13 <- wua(v_tanno_2012_rhith_pers_13)
wua_v_pers_tanno_rhith_15 <- wua(v_tanno_2012_rhith_pers_15)
wua_v_pers_tanno_rhith_18 <- wua(v_tanno_2012_rhith_pers_18)
wua_v_pers_tanno_rhith_22 <- wua(v_tanno_2012_rhith_pers_22)
wua_v_pers_tanno_rhith_25 <- wua(v_tanno_2012_rhith_pers_25)
wua_v_pers_tanno_rhith_28 <- wua(v_tanno_2012_rhith_pers_28)
wua_v_pers_tanno_rhith_32 <- wua(v_tanno_2012_rhith_pers_32)

# HABBY Rhithrogena -------------------------------------------
wua_v_pers_habby_rhith_2 <- wua(v_habby_rhith_pers_2)
wua_v_pers_habby_rhith_3 <- wua(v_habby_rhith_pers_3)
wua_v_pers_habby_rhith_4 <- wua(v_habby_rhith_pers_4)
wua_v_pers_habby_rhith_7 <- wua(v_habby_rhith_pers_7)
wua_v_pers_habby_rhith_9 <- wua(v_habby_rhith_pers_9)
wua_v_pers_habby_rhith_11 <- wua(v_habby_rhith_pers_11)
wua_v_pers_habby_rhith_13 <- wua(v_habby_rhith_pers_13)
wua_v_pers_habby_rhith_15 <- wua(v_habby_rhith_pers_15)
wua_v_pers_habby_rhith_18 <- wua(v_habby_rhith_pers_18)
wua_v_pers_habby_rhith_22 <- wua(v_habby_rhith_pers_22)
wua_v_pers_habby_rhith_25 <- wua(v_habby_rhith_pers_25)
wua_v_pers_habby_rhith_28 <- wua(v_habby_rhith_pers_28)
wua_v_pers_habby_rhith_32 <- wua(v_habby_rhith_pers_32)

# Tanno 2012: Baetis sp. -------------------------------------------
wua_v_pers_tanno_baetis_2 <- wua(v_tanno_2012_baetis_pers_2)
wua_v_pers_tanno_baetis_3 <- wua(v_tanno_2012_baetis_pers_3)
wua_v_pers_tanno_baetis_4 <- wua(v_tanno_2012_baetis_pers_4)
wua_v_pers_tanno_baetis_7 <- wua(v_tanno_2012_baetis_pers_7)
wua_v_pers_tanno_baetis_9 <- wua(v_tanno_2012_baetis_pers_9)
wua_v_pers_tanno_baetis_11 <- wua(v_tanno_2012_baetis_pers_11)
wua_v_pers_tanno_baetis_13 <- wua(v_tanno_2012_baetis_pers_13)
wua_v_pers_tanno_baetis_15 <- wua(v_tanno_2012_baetis_pers_15)
wua_v_pers_tanno_baetis_18 <- wua(v_tanno_2012_baetis_pers_18)
wua_v_pers_tanno_baetis_22 <- wua(v_tanno_2012_baetis_pers_22)
wua_v_pers_tanno_baetis_25 <- wua(v_tanno_2012_baetis_pers_25)
wua_v_pers_tanno_baetis_28 <- wua(v_tanno_2012_baetis_pers_28)
wua_v_pers_tanno_baetis_32 <- wua(v_tanno_2012_baetis_pers_32)
```

## f. Wetted Area [m2]
```{r}
# Only for one species, as WA_tot is the same for every species
# define function for WA_tot calculation -----------------------------------
wa_tot <- function(x, column_name){
  sum(x[[column_name]]) * 4
}

# Tanno 2012: Rhithrogena -------------------------------------------
# calculate feq_table for all Q's -----------------------------------
WA_tot_Tanno_2012_Rhithrogena_2 <- wa_tot(freq_GHSI_Tanno_2012_Rhithrogena_2, column_name = "count")
WA_tot_Tanno_2012_Rhithrogena_3 <- wa_tot(freq_GHSI_Tanno_2012_Rhithrogena_3, column_name = "count")
WA_tot_Tanno_2012_Rhithrogena_4 <- wa_tot(freq_GHSI_Tanno_2012_Rhithrogena_4, column_name = "count")
WA_tot_Tanno_2012_Rhithrogena_7 <- wa_tot(freq_GHSI_Tanno_2012_Rhithrogena_7, column_name = "count")
WA_tot_Tanno_2012_Rhithrogena_9 <- wa_tot(freq_GHSI_Tanno_2012_Rhithrogena_9, column_name = "count")
WA_tot_Tanno_2012_Rhithrogena_11 <- wa_tot(freq_GHSI_Tanno_2012_Rhithrogena_11, column_name = "count")
WA_tot_Tanno_2012_Rhithrogena_13 <- wa_tot(freq_GHSI_Tanno_2012_Rhithrogena_13, column_name = "count")
WA_tot_Tanno_2012_Rhithrogena_15 <- wa_tot(freq_GHSI_Tanno_2012_Rhithrogena_15, column_name = "count")
WA_tot_Tanno_2012_Rhithrogena_18 <- wa_tot(freq_GHSI_Tanno_2012_Rhithrogena_18, column_name = "count")
WA_tot_Tanno_2012_Rhithrogena_22 <- wa_tot(freq_GHSI_Tanno_2012_Rhithrogena_22, column_name = "count")
WA_tot_Tanno_2012_Rhithrogena_25 <- wa_tot(freq_GHSI_Tanno_2012_Rhithrogena_25, column_name = "count")
WA_tot_Tanno_2012_Rhithrogena_28 <- wa_tot(freq_GHSI_Tanno_2012_Rhithrogena_28, column_name = "count")
WA_tot_Tanno_2012_Rhithrogena_32 <- wa_tot(freq_GHSI_Tanno_2012_Rhithrogena_32, column_name = "count")
```

## g. Hydraulik Habitat Suitability [-]
```{r}
# Tanno 2012: Rhithrogena -------------------------------------------
# Q2.4
HHS_Tanno_2012_Rhithrogena_2 <- WUA_Tanno_2012_Rhithrogena_2/WA_tot_Tanno_2012_Rhithrogena_2

# Q3.9
HHS_Tanno_2012_Rhithrogena_3 <- WUA_Tanno_2012_Rhithrogena_3/WA_tot_Tanno_2012_Rhithrogena_3

# Q4.6
HHS_Tanno_2012_Rhithrogena_4 <- WUA_Tanno_2012_Rhithrogena_4/WA_tot_Tanno_2012_Rhithrogena_4

# Q7
HHS_Tanno_2012_Rhithrogena_7 <- WUA_Tanno_2012_Rhithrogena_7/WA_tot_Tanno_2012_Rhithrogena_7

# Q9
HHS_Tanno_2012_Rhithrogena_9 <- WUA_Tanno_2012_Rhithrogena_9/WA_tot_Tanno_2012_Rhithrogena_9

# Q11
HHS_Tanno_2012_Rhithrogena_11 <- WUA_Tanno_2012_Rhithrogena_11/WA_tot_Tanno_2012_Rhithrogena_11

# Q13.3
HHS_Tanno_2012_Rhithrogena_13 <- WUA_Tanno_2012_Rhithrogena_13/WA_tot_Tanno_2012_Rhithrogena_13

# Q15
HHS_Tanno_2012_Rhithrogena_15 <- WUA_Tanno_2012_Rhithrogena_15/WA_tot_Tanno_2012_Rhithrogena_15

# Q18
HHS_Tanno_2012_Rhithrogena_18 <- WUA_Tanno_2012_Rhithrogena_18/WA_tot_Tanno_2012_Rhithrogena_18

# Q22
HHS_Tanno_2012_Rhithrogena_22 <- WUA_Tanno_2012_Rhithrogena_22/WA_tot_Tanno_2012_Rhithrogena_22

# Q25
HHS_Tanno_2012_Rhithrogena_25 <- WUA_Tanno_2012_Rhithrogena_25/WA_tot_Tanno_2012_Rhithrogena_25

# Q28
HHS_Tanno_2012_Rhithrogena_28 <- WUA_Tanno_2012_Rhithrogena_28/WA_tot_Tanno_2012_Rhithrogena_28

# Q32.69
HHS_Tanno_2012_Rhithrogena_32 <- WUA_Tanno_2012_Rhithrogena_32/WA_tot_Tanno_2012_Rhithrogena_32


# HABBY Rhithrogena -------------------------------------------
# Q2.4
HHS_HABBY_Rhithrogena_2 <- WUA_HABBY_Rhithrogena_2/WA_tot_Tanno_2012_Rhithrogena_2

# Q3.9
HHS_HABBY_Rhithrogena_3 <- WUA_HABBY_Rhithrogena_3/WA_tot_Tanno_2012_Rhithrogena_3

# Q4.6
HHS_HABBY_Rhithrogena_4 <- WUA_HABBY_Rhithrogena_4/WA_tot_Tanno_2012_Rhithrogena_4

# Q7
HHS_HABBY_Rhithrogena_7 <- WUA_HABBY_Rhithrogena_7/WA_tot_Tanno_2012_Rhithrogena_7

# Q9
HHS_HABBY_Rhithrogena_9 <- WUA_HABBY_Rhithrogena_9/WA_tot_Tanno_2012_Rhithrogena_9

# Q11
HHS_HABBY_Rhithrogena_11 <- WUA_HABBY_Rhithrogena_11/WA_tot_Tanno_2012_Rhithrogena_11

# Q13.3
HHS_HABBY_Rhithrogena_13 <- WUA_HABBY_Rhithrogena_13/WA_tot_Tanno_2012_Rhithrogena_13

# Q15
HHS_HABBY_Rhithrogena_15 <- WUA_HABBY_Rhithrogena_15/WA_tot_Tanno_2012_Rhithrogena_15

# Q18
HHS_HABBY_Rhithrogena_18 <- WUA_HABBY_Rhithrogena_18/WA_tot_Tanno_2012_Rhithrogena_18

# Q22
HHS_HABBY_Rhithrogena_22 <- WUA_HABBY_Rhithrogena_22/WA_tot_Tanno_2012_Rhithrogena_22

# Q25
HHS_HABBY_Rhithrogena_25 <- WUA_HABBY_Rhithrogena_25/WA_tot_Tanno_2012_Rhithrogena_25

# Q28
HHS_HABBY_Rhithrogena_28 <- WUA_HABBY_Rhithrogena_28/WA_tot_Tanno_2012_Rhithrogena_28

# Q32.69
HHS_HABBY_Rhithrogena_32 <- WUA_HABBY_Rhithrogena_32/WA_tot_Tanno_2012_Rhithrogena_32

# Tanno 2012: Baetis sp. -------------------------------------------
# Q2.4
HHS_Tanno_2012_Baetis_2 <- WUA_Tanno_2012_Baetis_2/WA_tot_Tanno_2012_Rhithrogena_2

# Q3.9
HHS_Tanno_2012_Baetis_3 <- WUA_Tanno_2012_Baetis_3/WA_tot_Tanno_2012_Rhithrogena_3

# Q4.6
HHS_Tanno_2012_Baetis_4 <- WUA_Tanno_2012_Baetis_4/WA_tot_Tanno_2012_Rhithrogena_4

# Q7
HHS_Tanno_2012_Baetis_7 <- WUA_Tanno_2012_Baetis_7/WA_tot_Tanno_2012_Rhithrogena_7

# Q9
HHS_Tanno_2012_Baetis_9 <- WUA_Tanno_2012_Baetis_9/WA_tot_Tanno_2012_Rhithrogena_9

# Q11
HHS_Tanno_2012_Baetis_11 <- WUA_Tanno_2012_Baetis_11/WA_tot_Tanno_2012_Rhithrogena_11

# Q13.3
HHS_Tanno_2012_Baetis_13 <- WUA_Tanno_2012_Baetis_13/WA_tot_Tanno_2012_Rhithrogena_13

# Q15
HHS_Tanno_2012_Baetis_15 <- WUA_Tanno_2012_Baetis_15/WA_tot_Tanno_2012_Rhithrogena_15

# Q18
HHS_Tanno_2012_Baetis_18 <- WUA_Tanno_2012_Baetis_18/WA_tot_Tanno_2012_Rhithrogena_18

# Q22
HHS_Tanno_2012_Baetis_22 <- WUA_Tanno_2012_Baetis_22/WA_tot_Tanno_2012_Rhithrogena_22

# Q25
HHS_Tanno_2012_Baetis_25 <- WUA_Tanno_2012_Baetis_25/WA_tot_Tanno_2012_Rhithrogena_25

# Q28
HHS_Tanno_2012_Baetis_28 <- WUA_Tanno_2012_Baetis_28/WA_tot_Tanno_2012_Rhithrogena_28

# Q32.69
HHS_Tanno_2012_Baetis_32 <- WUA_Tanno_2012_Baetis_32/WA_tot_Tanno_2012_Rhithrogena_32
```

# 4. make dataframe and .csv of calculated indices 
```{r}
# data frame WUA and HHS -------------------------------------------
results <- data.frame(Description = c("Tanno 2012 Baetis sp.", "Tanno 2012 Baetis sp.", "Tanno 2012 Baetis sp.", "Tanno 2012 Baetis sp.", "Tanno 2012 Baetis sp.", "Tanno 2012 Baetis sp.", "Tanno 2012 Baetis sp.", "Tanno 2012 Baetis sp.", "Tanno 2012 Baetis sp.", "Tanno 2012 Baetis sp.", "Tanno 2012 Baetis sp.", "Tanno 2012 Baetis sp.", "Tanno 2012 Baetis sp.", "Tanno 2012 Rhithrogena sp.", "Tanno 2012 Rhithrogena sp.", "Tanno 2012 Rhithrogena sp.", "Tanno 2012 Rhithrogena sp.", "Tanno 2012 Rhithrogena sp.", "Tanno 2012 Rhithrogena sp.", "Tanno 2012 Rhithrogena sp.", "Tanno 2012 Rhithrogena sp.", "Tanno 2012 Rhithrogena sp.", "Tanno 2012 Rhithrogena sp.", "Tanno 2012 Rhithrogena sp.", "Tanno 2012 Rhithrogena sp.", "Tanno 2012 Rhithrogena sp.", "HABBY Rhithrogena eaton larva", "HABBY Rhithrogena eaton larva", "HABBY Rhithrogena eaton larva", "HABBY Rhithrogena eaton larva", "HABBY Rhithrogena eaton larva", "HABBY Rhithrogena eaton larva", "HABBY Rhithrogena eaton larva", "HABBY Rhithrogena eaton larva", "HABBY Rhithrogena eaton larva", "HABBY Rhithrogena eaton larva", "HABBY Rhithrogena eaton larva", "HABBY Rhithrogena eaton larva","HABBY Rhithrogena eaton larva"), Discharge = c(2.4, 3.9, 4.6, 7, 9, 11.4, 13.3, 15, 18.9, 22, 25, 28, 32.69, 2.4, 3.9, 4.6, 7, 9, 11.4, 13.3, 15, 18.9, 22, 25, 28, 32.69, 2.4, 3.9, 4.6, 7, 9, 11.4, 13.3, 15, 18.9, 22, 25, 28, 32.69), 
                      WUA_normal = c(WUA_Tanno_2012_Baetis_2, WUA_Tanno_2012_Baetis_3, WUA_Tanno_2012_Baetis_4, WUA_Tanno_2012_Baetis_7, WUA_Tanno_2012_Baetis_9, WUA_Tanno_2012_Baetis_11, WUA_Tanno_2012_Baetis_13, WUA_Tanno_2012_Baetis_15, WUA_Tanno_2012_Baetis_18, WUA_Tanno_2012_Baetis_22, WUA_Tanno_2012_Baetis_25, WUA_Tanno_2012_Baetis_28, WUA_Tanno_2012_Baetis_32, WUA_Tanno_2012_Rhithrogena_2, WUA_Tanno_2012_Rhithrogena_3, WUA_Tanno_2012_Rhithrogena_4, WUA_Tanno_2012_Rhithrogena_7, WUA_Tanno_2012_Rhithrogena_9, WUA_Tanno_2012_Rhithrogena_11, WUA_Tanno_2012_Rhithrogena_13, WUA_Tanno_2012_Rhithrogena_15, WUA_Tanno_2012_Rhithrogena_18, WUA_Tanno_2012_Rhithrogena_22, WUA_Tanno_2012_Rhithrogena_25, WUA_Tanno_2012_Rhithrogena_28, WUA_Tanno_2012_Rhithrogena_32, WUA_HABBY_Rhithrogena_2, WUA_HABBY_Rhithrogena_3, WUA_HABBY_Rhithrogena_4, WUA_HABBY_Rhithrogena_7, WUA_HABBY_Rhithrogena_9, WUA_HABBY_Rhithrogena_11, WUA_HABBY_Rhithrogena_13, WUA_HABBY_Rhithrogena_15, WUA_HABBY_Rhithrogena_18, WUA_HABBY_Rhithrogena_22, WUA_HABBY_Rhithrogena_25, WUA_HABBY_Rhithrogena_28, WUA_HABBY_Rhithrogena_32), 
                      WUA_pers_GHSI = c(WUA_pers_Tanno_2012_Baetis_2, WUA_pers_Tanno_2012_Baetis_3, WUA_pers_Tanno_2012_Baetis_4, WUA_pers_Tanno_2012_Baetis_7, WUA_pers_Tanno_2012_Baetis_9, WUA_pers_Tanno_2012_Baetis_11, WUA_pers_Tanno_2012_Baetis_13, WUA_pers_Tanno_2012_Baetis_15, WUA_pers_Tanno_2012_Baetis_18, WUA_pers_Tanno_2012_Baetis_22, WUA_pers_Tanno_2012_Baetis_25, WUA_pers_Tanno_2012_Baetis_28, WUA_pers_Tanno_2012_Baetis_32, WUA_pers_Tanno_2012_Rhithrogena_2, WUA_pers_Tanno_2012_Rhithrogena_3, WUA_pers_Tanno_2012_Rhithrogena_4, WUA_pers_Tanno_2012_Rhithrogena_7, WUA_pers_Tanno_2012_Rhithrogena_9, WUA_pers_Tanno_2012_Rhithrogena_11, WUA_pers_Tanno_2012_Rhithrogena_13, WUA_pers_Tanno_2012_Rhithrogena_15, WUA_pers_Tanno_2012_Rhithrogena_18, WUA_pers_Tanno_2012_Rhithrogena_22, WUA_pers_Tanno_2012_Rhithrogena_25, WUA_pers_Tanno_2012_Rhithrogena_28, WUA_pers_Tanno_2012_Rhithrogena_32, WUA_pers_HABBY_Rhithrogena_2, WUA_pers_HABBY_Rhithrogena_3, WUA_pers_HABBY_Rhithrogena_4, WUA_pers_HABBY_Rhithrogena_7, WUA_pers_HABBY_Rhithrogena_9, WUA_pers_HABBY_Rhithrogena_11, WUA_pers_HABBY_Rhithrogena_13, WUA_pers_HABBY_Rhithrogena_15, WUA_pers_HABBY_Rhithrogena_18, WUA_pers_HABBY_Rhithrogena_22, WUA_pers_HABBY_Rhithrogena_25, WUA_pers_HABBY_Rhithrogena_28, WUA_pers_HABBY_Rhithrogena_32),
                      WUA_pers_V = c(wua_v_pers_tanno_baetis_2, wua_v_pers_tanno_baetis_3, wua_v_pers_tanno_baetis_4, wua_v_pers_tanno_baetis_7, wua_v_pers_tanno_baetis_9, wua_v_pers_tanno_baetis_11, wua_v_pers_tanno_baetis_13, wua_v_pers_tanno_baetis_15, wua_v_pers_tanno_baetis_18, wua_v_pers_tanno_baetis_22, wua_v_pers_tanno_baetis_25, wua_v_pers_tanno_baetis_28, wua_v_pers_tanno_baetis_32, wua_v_pers_tanno_rhith_2, wua_v_pers_tanno_rhith_3, wua_v_pers_tanno_rhith_4, wua_v_pers_tanno_rhith_7, wua_v_pers_tanno_rhith_9, wua_v_pers_tanno_rhith_11, wua_v_pers_tanno_rhith_13, wua_v_pers_tanno_rhith_15, wua_v_pers_tanno_rhith_18, wua_v_pers_tanno_rhith_22, wua_v_pers_tanno_rhith_25, wua_v_pers_tanno_rhith_28, wua_v_pers_tanno_rhith_32, wua_v_pers_habby_rhith_2, wua_v_pers_habby_rhith_3, wua_v_pers_habby_rhith_4, wua_v_pers_habby_rhith_7, wua_v_pers_habby_rhith_9, wua_v_pers_habby_rhith_11, wua_v_pers_habby_rhith_13, wua_v_pers_habby_rhith_15, wua_v_pers_habby_rhith_18, wua_v_pers_habby_rhith_22, wua_v_pers_habby_rhith_25, wua_v_pers_habby_rhith_28, wua_v_pers_habby_rhith_32), 
                      HHS = c(HHS_Tanno_2012_Baetis_2, HHS_Tanno_2012_Baetis_3, HHS_Tanno_2012_Baetis_4, HHS_Tanno_2012_Baetis_7, HHS_Tanno_2012_Baetis_9, HHS_Tanno_2012_Baetis_11, HHS_Tanno_2012_Baetis_13, HHS_Tanno_2012_Baetis_15, HHS_Tanno_2012_Baetis_18, HHS_Tanno_2012_Baetis_22, HHS_Tanno_2012_Baetis_25, HHS_Tanno_2012_Baetis_28, HHS_Tanno_2012_Baetis_32, HHS_Tanno_2012_Rhithrogena_2, HHS_Tanno_2012_Rhithrogena_3, HHS_Tanno_2012_Rhithrogena_4, HHS_Tanno_2012_Rhithrogena_7, HHS_Tanno_2012_Rhithrogena_9, HHS_Tanno_2012_Rhithrogena_11, HHS_Tanno_2012_Rhithrogena_13, HHS_Tanno_2012_Rhithrogena_15, HHS_Tanno_2012_Rhithrogena_18, HHS_Tanno_2012_Rhithrogena_22, HHS_Tanno_2012_Rhithrogena_25, HHS_Tanno_2012_Rhithrogena_28, HHS_Tanno_2012_Rhithrogena_32, HHS_HABBY_Rhithrogena_2, HHS_HABBY_Rhithrogena_3, HHS_HABBY_Rhithrogena_4, HHS_HABBY_Rhithrogena_7, HHS_HABBY_Rhithrogena_9, HHS_HABBY_Rhithrogena_11, HHS_HABBY_Rhithrogena_13, HHS_HABBY_Rhithrogena_15, HHS_HABBY_Rhithrogena_18, HHS_HABBY_Rhithrogena_22, HHS_HABBY_Rhithrogena_25, HHS_HABBY_Rhithrogena_28, HHS_HABBY_Rhithrogena_32),
                      WA_tot = c(WA_tot_Tanno_2012_Rhithrogena_2, WA_tot_Tanno_2012_Rhithrogena_3, WA_tot_Tanno_2012_Rhithrogena_4, WA_tot_Tanno_2012_Rhithrogena_7, WA_tot_Tanno_2012_Rhithrogena_9, WA_tot_Tanno_2012_Rhithrogena_11, WA_tot_Tanno_2012_Rhithrogena_13, WA_tot_Tanno_2012_Rhithrogena_15, WA_tot_Tanno_2012_Rhithrogena_18, WA_tot_Tanno_2012_Rhithrogena_22, WA_tot_Tanno_2012_Rhithrogena_25, WA_tot_Tanno_2012_Rhithrogena_28, WA_tot_Tanno_2012_Rhithrogena_32, WA_tot_Tanno_2012_Rhithrogena_2, WA_tot_Tanno_2012_Rhithrogena_3, WA_tot_Tanno_2012_Rhithrogena_4, WA_tot_Tanno_2012_Rhithrogena_7, WA_tot_Tanno_2012_Rhithrogena_9, WA_tot_Tanno_2012_Rhithrogena_11, WA_tot_Tanno_2012_Rhithrogena_13, WA_tot_Tanno_2012_Rhithrogena_15, WA_tot_Tanno_2012_Rhithrogena_18, WA_tot_Tanno_2012_Rhithrogena_22, WA_tot_Tanno_2012_Rhithrogena_25, WA_tot_Tanno_2012_Rhithrogena_28, WA_tot_Tanno_2012_Rhithrogena_32, WA_tot_Tanno_2012_Rhithrogena_2, WA_tot_Tanno_2012_Rhithrogena_3, WA_tot_Tanno_2012_Rhithrogena_4, WA_tot_Tanno_2012_Rhithrogena_7, WA_tot_Tanno_2012_Rhithrogena_9, WA_tot_Tanno_2012_Rhithrogena_11, WA_tot_Tanno_2012_Rhithrogena_13, WA_tot_Tanno_2012_Rhithrogena_15, WA_tot_Tanno_2012_Rhithrogena_18, WA_tot_Tanno_2012_Rhithrogena_22, WA_tot_Tanno_2012_Rhithrogena_25, WA_tot_Tanno_2012_Rhithrogena_28, WA_tot_Tanno_2012_Rhithrogena_32))

# write data frame into .csv file -------------------------------------------
write.csv(results, file = "results_statistics/Results_Multivariate_Habitat_Model.csv", row.names = FALSE)
```

# 2a. Veränderung Habitatverfügbarkeit in Abhängigkeit versch. Abflüsse 
```{r}
library("readr")
library("tidyr")
library("dplyr")
library("ggplot2")
# install.packages("ggforce")
library("ggforce")
# make data frame for plotting -------------------------------------------
WUA_HHS <- read_delim("results_statistics/Results_Multivariate_Habitat_Model.csv")

WUA_HHS_1 <- read_delim("results_statistics/Results_VZH_Habitat_Model.csv")

# bind the two data frames together --------------------------------------
WUA_HHS <- WUA_HHS |>
  select(-WUA_pers_V)

# Rename a column using colnames()
colnames(WUA_HHS)[colnames(WUA_HHS) == "WUA_pers_GHSI"] <- "WUA_pers"

WUA_HHS <- rbind(WUA_HHS, WUA_HHS_1)

# make variable with WUA normal/persistent -----------------------------------
# long format to plot in facet_wrap 
WUA_normal <- WUA_HHS[ , c(1:3)]
WUA_pers <- WUA_HHS[ , c(1,2,4)]
HHS_normal <- WUA_HHS[ , c(1,2,5)]
HHS_pers <- WUA_HHS[ , c(1,2,5)]

       
WUA_long <- pivot_longer(WUA_HHS, cols = c(WUA_normal, WUA_pers, HHS), names_to = "WUA_HHS", values_to = "value")


# Define a custom labelling function
my_labeller <- function(variable, value) {
  if (variable == "WUA_HHS") {
    return(c("WUA_normal" = "WUA", "WUA_pers" = "WUA persistent", "HHS" = "HHS")[value])
  } 
}
# facet_wrap(WUA_HHS~Description, ncol = 3, nrow = 3, labeller = my_labeller) +

# Plot WUA ALL  -----------------------------------
plot <- ggplot(WUA_long, aes(Discharge, value, col = Description)) +
  facet_wrap(WUA_HHS~Description, scales = "free_y", labeller = my_labeller) +
  geom_point(size = 2) +
  geom_line(lwd = 0.7) +
  labs(title = "Comparing Weightes Usable Area (WUA) of three macroinvertebrates", x = expression(paste("Discharge [", m^3/s, "]")), y = "Y", col = "Macroinvertebrates") +
  theme_gray()

# Adjust the y-axis on a specific row
plot +
  scale_y_continuous(
    limits = ifelse(WUA_long$WUA_HHS == "HHS", c(0, 1), c(0, 5000)),
    expand = c(0, 0),
    name = "Y"
  )
```


```{r}
# HHS Plots ALL -----------------------------------
HHS_results <- ggplot(WUA_HHS, aes(Discharge, HHS, col = Description)) +
  facet_wrap(~Description) +
  geom_point(size = 2) +
  geom_line(lwd = 0.7) +
  labs(title = "Comparing Hydraulic Habitat Suitability (HHS) of three macroinvertebrates", x = expression(paste("Discharge [", m^3/s, "]")), y = "HHS [-]", col = "Macroinvertebrates") +
  theme_gray()

# WA tot results -----------------------------------
WA_tot_results <- ggplot(WUA_HHS, aes(Discharge, WA_tot)) +
  geom_line(lwd = 0.7) +
  geom_point(size = 2) +
  labs(title = "Comparing total wetted area of 13 discharges", x = expression(paste("Discharge [", m^3/s, "]")), y = expression(paste("Wettet Area [", m^2, "]"))) +
  theme_gray()
```

```{r}
# save plots into .png
# set the dimensions of the quadrat
quadrat_width <- 30 # in cm
quadrat_height <- 25 # in cm

# WUA 
ggsave(filename = "results_statistics/WUA_results.png",plot = WUA_results, width = quadrat_width, height = quadrat_height, units = "cm")

quadrat_width1 <- 30 # in cm
quadrat_height1 <- 15 # in cm
# HHS
ggsave(filename = "results_statistics/HHS_results.png",plot = HHS_results, width = quadrat_width1, height = quadrat_height1, units = "cm")

# WA_tot
ggsave(filename = "results_statistics/WA_tot_results.png",plot = WA_tot_results, width = quadrat_width, height = quadrat_height, units = "cm")
```






